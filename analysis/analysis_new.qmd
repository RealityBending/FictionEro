---
title: "FictionEro - Affective Impact of Fiction"
editor: source
editor_options: 
  chunk_output_type: console
format:
  html:
    toc: true
    code-fold: true
    self-contained: false
execute: 
  cache: true
---


# Data Preparation

```{r libraries}
#| message: false
#| warning: false

library(dplyr)
library(tidyverse)
library(easystats)
library(patchwork)
library(ggside)
library(glmmTMB)
library(gt)
library(ggdist)
library(posterior)
library(forcats)

options(mc.cores = parallel::detectCores(),
        brms.backend = "cmdstanr",
        width = 300)
```

```{r functions}

results_table <- function(model, effects="fixed", filter=NULL) {
  if("marginaleffects" %in% class(model)) {
    model |> 
      parameters::parameters() |> 
      as.data.frame() |> 
      select(-Parameter, -SE, -S, z=Statistic) |> 
      insight::format_table() |> 
      parameters::display()
  } else {
    display(parameters::parameters(model, effects=effects, keep=filter))
  }
}

# Parameters tables for the models 
params_table <- function(m) {
  d <- as.data.frame(m, variable = insight::find_parameters(m, effects = "fixed", flatten  = TRUE))
  t <- bayestestR::describe_posterior(d, effects = "fixed", component = "all", ci_method = "hdi", test = "p_direction")
  out <- insight::format_table(t)
  out |> 
    mutate(col = t$pd) |> 
    gt::gt() |> 
    gt::data_color(columns = "col", method = "numeric", target_columns = "pd", 
                   row = col > 0.95, palette = "yellow") |> 
    gt::data_color(columns = "col", method = "numeric", target_columns = "pd", 
                   row = col > 0.97, palette = "green") |> 
    gt::cols_hide("col")
}

# Random effects table
table_dvour <- function(g) {
  performance::performance_dvour(g) |> 
    arrange(desc(D_vour)) |> 
    gt::gt() |> 
    gt::data_color("D_vour", palette = c("red","green"), domain = c(0, 1)) |> 
    gt::fmt_auto()
}
```

```{r data study1}
#| warning: false

dfsub1 <- dfsub <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study1/data/data_participants.csv")
df1 <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study1/data/data.csv") |> 
  right_join(
    select(dfsub1, Participant, Sample, Language, Mobile, starts_with("Feedback_"), 
           BAIT_Visual, BAIT_Text, AI_Knowledge, SexualActivity, 
           GAAIS_Negative, GAAIS_Positive, Porn, COPS_Frequency_2,
           Screen_Size,
           -Feedback_Comments),
    by = "Participant") |> 
  rename(Gender = Sex) |>
  datawizard::rescale(select=c("Valence"), range=c(-1, 1), to=c(0, 1)) |> 
  mutate(Condition = fct_recode(Condition, "Photograph" = "Photograph", "AIGenerated" = "AI-Generated"),
         Condition = fct_relevel(Condition, "Photograph", "AIGenerated"),
         Relevance = fct_recode(Relevance,  "Relevant" = "Relevant",  "Irrelevant"= "Irrelevant", "NonErotic" = "Non-erotic"),
         Relevance =  fct_relevel(Relevance, "Relevant", "Irrelevant", "NonErotic"),
         Gender =  fct_relevel(Gender, "Male", "Female"),
         ConditionBelief = case_when(
           Condition == "Photograph" & Realness > 0.5 ~ "True",
           Condition == "AIGenerated" & Realness < 0.5 ~ "True",
           .default = "False"),
         ConditionBelief = as.factor(ConditionBelief),
         ConditionBelief = fct_relevel(ConditionBelief, "True", "False"),
         PornFrequency = as.numeric(as.factor(COPS_Frequency_2)),
         SexualActivity_num = as.numeric(as.factor(SexualActivity)),
         across(starts_with("Feedback_"), function(x) {fct_relevel(x, "False", "True")}))
```

```{r data study2}
#| warning: false

dfsub2 <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study2/data/data_participants.csv")
df2 <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study2/data/data.csv") |> 
  right_join(
    select(dfsub2, Participant, Mobile, starts_with(c("Feedback_","BAIT")), COPS_Frequency, SexualActivity,- Feedback_Text),
    by = "Participant"
  ) |> 
  datawizard::rescale(select= c("Arousal", "Enticing", "Valence"), range=c(0, 6), to=c(0,1)) |>
  datawizard::rescale(select= c("Realness"), range=c(-3,3), to=c(0,1)) |>
  filter(SexualOrientation == "Heterosexual") |> # Keep only heterosexuals
  mutate(Gender =  fct_relevel(Gender, "Male", "Female"),
         Condition = case_when(
           Condition == "Fiction" ~ "AIGenerated",
           Condition == "Reality" ~ "Photograph"), 
         Condition = fct_relevel(Condition, "Photograph", "AIGenerated"),
         ConditionBelief = case_when(
           Condition == "Photograph" & Realness > 0.5 ~ "True",
           Condition == "AIGenerated" & Realness < 0.5 ~ "True",
           .default = "False"),
         ConditionBelief = as.factor(ConditionBelief),
         ConditionBelief = fct_relevel(ConditionBelief, "True", "False"),
         PornFrequency = as.numeric(as.factor(COPS_Frequency)),
         SexualActivity_num = as.numeric(as.factor(SexualActivity)),
         across(starts_with("Feedback_"), as.factor), 
         across(starts_with("Feedback_"), function(x) {fct_relevel(x, "False", "True")})) |>
    rename(Item = Stimulus,
           Enticement = Enticing,
           AllRealConfidence = "Feedback_AllRealConfidence",
           AllFakeConfidence = "Feedback_AllFakeConfidence",
           Enjoyment = "Feedback_Enjoyment") 
```


# Study 1

## Rate Belief

```{r ratebelief 1}

rate1 <- table(df1$Feedback_LabelsIncorrect)["True"] / sum(table(df1$Feedback_LabelsIncorrect))
```

The rate of people that did not believe the instructions in study 1 (i.e., gave feedback that the labels were incorrect) was `r round(mean(rate1) * 100, 1)`%.

## Arousal

### Manipulation Checks
::: {.panel-tabset}

#### Distributions

```{r dist arousal 1}
#| fig-width: 12
arousal_dist1 <- df1 |>
  ggplot(aes(x=Arousal, fill = Condition)) +
  geom_histogram(position = "identity", alpha = 0.5, colour = "black", bins = 30) +
  scale_x_continuous(breaks = c(0, 1)) +
  labs(title = "Arousal Study 1", ) +
  facet_wrap(~Gender) +
  scale_fill_manual(values=c("AIGenerated"="#2196F3", "Photograph"="#F44336")) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))


arousal_dist1
```

#### Averages 

```{r arousal 1 t_test}
#| message: false

dfsub1 <- dfsub1 |>
  right_join(
    df1 |>
      group_by(Participant, Condition) |>
      summarise(mean_arousal = mean(Arousal, na.rm = TRUE), .groups = "drop") |>
      pivot_wider(
        names_from = Condition,
        names_prefix = "mean_Arousal_",
        values_from = mean_arousal
      ) |>
      mutate(diff_arousal = `mean_Arousal_AIGenerated` - mean_Arousal_Photograph)
  )

ttest1 <- stats::t.test(diff_arousal ~ Feedback_AILessArousing, data = dfsub1)
```

```{r arousal 1 diff plot}
diff_plot1 <- dfsub1 |> 
  ggplot(aes(x = Feedback_AILessArousing, y = diff_arousal, fill = Feedback_AILessArousing)) +
  geom_boxplot(width = 0.4,alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.1, size = 1) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 2, fill = "black") +
  labs(
    title = "Study 1",
    x = "Participant said AI is less arousing",
    y = "Arousal Difference (AI - Photo)"
  ) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.position = "none"
  )

diff_plot1
```

**Study 1**: `r report::report(ttest1, data = dfsub1)`
:::

### Effect of Manipulation

```{r arousal 1 by condition belief plot }
df1 |> 
  ggplot(aes(x = Gender, y = Arousal, fill = ConditionBelief)) +
  geom_violin(position = position_dodge(width = 1), alpha = 0.7, trim = FALSE) +
  stat_pointinterval(position = position_dodge(width = 1),point_size = 1.5) +
  facet_grid(Relevance ~ Condition) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal(base_size = 14) +
  labs(subtitle ="Study 1", x = "Gender",y = "Arousal",fill = " Condition Belief")
```

```{r arousal 1 model}
m <- readRDS("models/ZOIB/ModelArousal_1_ZOIB.rds")

params_table(m)
summary(m, robust = TRUE)
performance::performance(m)
```


### Interindividual Variability
::: {.panel-tabset}


#### Random effects
```{r arousal d_vour}
m <- modelbased::estimate_grouplevel(m)
table_dvour(m)
```

#### Participant effects 

```{r arousal ppt effects}
colors <- c("Intercept" = "#9C27B0", "ConditionAIGenerated" = "#FF9800")

p_dvour <- m |> 
   mutate(Group = fct_relevel(Group, "Participant", "Item"),
          Parameter = fct_relevel(Parameter, "Intercept", "ConditionAIGenerated")) |>
  ggplot(aes(x = Median , y = Level)) +
  geom_pointrange(aes(xmin = CI_low, xmax = CI_high, color = Parameter), linewidth = 0.3, size = 0.05) +
  facet_grid(Group~Parameter, scales = "free", switch="both") +
  ggside::ggside(scales  = "free") +
  ggside::geom_xsidedensity(aes(group = Parameter, fill = Parameter), color = NA) +
  ggside::ggside(scales  = "free") +
  scale_color_manual(values = colors) +
  scale_fill_manual(values = colors) +
  theme_minimal() +
  theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        strip.placement.x = "outside",
        strip.background = element_rect(fill = NA, color = NA),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(),
        legend.position = "none")
p_dvour
```
:::
### Correlations (moderators)


```{r arousal 1 corr}

correlations <- df1 |>
  select(Participant, starts_with("Feedback"), starts_with("BAIT"), starts_with("GAIS"), starts_with("Porn"), "AI_Knowledge", "SexualActivity_num", "COPS_Frequency_2")

features1 <- reshape_grouplevel(m, indices = "Median", group = "Participant") |> 
  datawizard::data_addprefix("ZOIB_", exclude = "Participant") |>
  full_join(correlations, by = "Participant") 
  

cordata <- correlation::correlation(select(features1, -Participant), p_adjust = "none", redundant = TRUE) |> 
  correlation::cor_sort() |> 
  correlation::cor_lower() |>
  as.data.frame()

p2_cor <- cordata |> 
  ggplot(aes(x=Parameter2, y = Parameter1)) +
  geom_tile(aes(fill = r)) +
  geom_text(aes(label = insight::format_value(r, 2, zap_small = TRUE, lead_zero = FALSE)), color = ifelse(cordata$p < 0.01, "black", "grey")) +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.position = "none"
  )
p2_cor

```

## Enticement

### Manipulation Checks

::: {.panel-tabset}

#### Distributions 

```{r dist enticement 1}
#| fig-width: 12
enticement_dist1 <- df1 |>
  ggplot(aes(x=Enticement, fill = Condition)) +
  geom_histogram(position = "identity", alpha = 0.5, colour = "black", bins = 30) +
  scale_x_continuous(breaks = c(0, 1)) +
  labs(title = "Enticement Study 1", ) +
  facet_wrap(~Gender) +
  scale_fill_manual(values=c("AIGenerated"="#2196F3", "Photograph"="#F44336")) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))


enticement_dist1
```

#### Averages 

```{r enticement 1 t_test}
#| message: false

dfsub1 <- dfsub1 |>
  right_join(
    df1 |>
      group_by(Participant, Condition) |>
      summarise(mean_Enticement = mean(Enticement, na.rm = TRUE), .groups = "drop") |>
      pivot_wider(
        names_from = Condition,
        names_prefix = "mean_Enticement_",
        values_from = mean_Enticement
      ) |>
      mutate(diff_enticement = `mean_Enticement_AIGenerated` - mean_Enticement_Photograph)
  )

ttest1 <- stats::t.test(diff_enticement ~ Feedback_AILessArousing, data = dfsub1)
```

```{r enticement 1 diff plot}
diff_plot1 <- dfsub1 |> 
  ggplot(aes(x = Feedback_AILessArousing, y = diff_enticement, fill = Feedback_AILessArousing)) +
  geom_boxplot(width = 0.4,alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.1, size = 1) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 2, fill = "black") +
  labs(
    title = "Study 1",
    x = "Participant said AI is less arousing",
    y = "Enticment Difference (AI - Photo)"
  ) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.position = "none"
  )

diff_plot1
```

**Study 1**: `r report::report(ttest1, data = dfsub1)`

:::

### Effect of Manipulation

```{r enticement 1 by condition belief plot }
df1 |> 
  ggplot(aes(x = Gender, y = Enticement, fill = ConditionBelief)) +
  geom_violin(position = position_dodge(width = 1), alpha = 0.7, trim = FALSE) +
  stat_pointinterval(position = position_dodge(width = 1),point_size = 1.5) +
  facet_grid(Relevance ~ Condition) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal(base_size = 14) +
  labs(subtitle ="Study 1", x = "Gender",y = "Arousal",fill = " Condition Belief")
```

```{r enticement 1 model}
m <- readRDS("models/ZOIB/ModelEnticement_1_ZOIB.rds")

params_table(m)
summary(m, robust = TRUE)
performance::performance(m)
```


### Interindividual Variability
:::: {.panel-tabset}

#### Random effects
```{r enticement d_vour}
m <- modelbased::estimate_grouplevel(m)
table_dvour(m)
```

#### Participant effects 

```{r enticement ppt effects}
colors <- c("Intercept" = "#9C27B0", "ConditionAIGenerated" = "#FF9800")

p_dvour <- m |> 
   mutate(Group = fct_relevel(Group, "Participant", "Item"),
          Parameter = fct_relevel(Parameter, "Intercept", "ConditionAIGenerated")) |>
  ggplot(aes(x = Median , y = Level)) +
  geom_pointrange(aes(xmin = CI_low, xmax = CI_high, color = Parameter), linewidth = 0.3, size = 0.05) +
  facet_grid(Group~Parameter, scales = "free", switch="both") +
  ggside::ggside(scales  = "free") +
  ggside::geom_xsidedensity(aes(group = Parameter, fill = Parameter), color = NA) +
  ggside::ggside(scales  = "free") +
  scale_color_manual(values = colors) +
  scale_fill_manual(values = colors) +
  theme_minimal() +
  theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        strip.placement.x = "outside",
        strip.background = element_rect(fill = NA, color = NA),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(),
        legend.position = "none")
p_dvour
```
:::

### Correlations (moderators)

```{r enticement  1 corr}

correlations <- df1 |>
  select(Participant, starts_with("Feedback"), starts_with("BAIT"), starts_with("GAIS"), starts_with("Porn"), "AI_Knowledge", "SexualActivity_num", "COPS_Frequency_2")

features1 <- reshape_grouplevel(m, indices = "Median", group = "Participant") |> 
  datawizard::data_addprefix("ZOIB_", exclude = "Participant") |>
  full_join(correlations, by = "Participant") 
  

cordata <- correlation::correlation(select(features1, -Participant), p_adjust = "none", redundant = TRUE) |> 
  correlation::cor_sort() |> 
  correlation::cor_lower() |>
  as.data.frame()

p2_cor <- cordata |> 
  ggplot(aes(x=Parameter2, y = Parameter1)) +
  geom_tile(aes(fill = r)) +
  geom_text(aes(label = insight::format_value(r, 2, zap_small = TRUE, lead_zero = FALSE)), color = ifelse(cordata$p < 0.01, "black", "grey")) +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.position = "none"
  )
p2_cor

```

## Valence

### Manipulation Checks

::: {.panel-tabset}

#### Distributions

```{r dist valence 1}
#| fig-width: 12
valence_dist1 <- df1 |>
  ggplot(aes(x=Valence, fill = Condition)) +
  geom_histogram(position = "identity", alpha = 0.5, colour = "black", bins = 30) +
  scale_x_continuous(breaks = c(0, 1)) +
  labs(title = "Valence Study 1", ) +
  facet_wrap(~Gender) +
  scale_fill_manual(values=c("AIGenerated"="#2196F3", "Photograph"="#F44336")) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))


valence_dist1
```

#### Averages 

```{r valence 1 t_test}
#| message: false

dfsub1 <- dfsub1 |>
  right_join(
    df1 |>
      group_by(Participant, Condition) |>
      summarise(mean_Valence = mean(Valence, na.rm = TRUE), .groups = "drop") |>
      pivot_wider(
        names_from = Condition,
        names_prefix = "mean_Valence_",
        values_from = mean_Valence
      ) |>
      mutate(diff_valence = `mean_Valence_AIGenerated` - mean_Valence_Photograph)
  )

ttest1 <- stats::t.test(diff_valence ~ Feedback_AILessArousing, data = dfsub1)
```

```{r valence 1 diff plot}
diff_plot1 <- dfsub1 |> 
  ggplot(aes(x = Feedback_AILessArousing, y = diff_valence, fill = Feedback_AILessArousing)) +
  geom_boxplot(width = 0.4,alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.1, size = 1) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 2, fill = "black") +
  labs(
    title = "Study 1",
    x = "Participant said AI is less arousing",
    y = "Valence Difference (AI - Photo)"
  ) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.position = "none"
  )

diff_plot1
```

**Study 1**: `r report::report(ttest1, data = dfsub1)`

:::

### Effect of Manipulation

```{r valence 1 by condition belief plot }
df1 |> 
  ggplot(aes(x = Gender, y = Enticement, fill = ConditionBelief)) +
  geom_violin(position = position_dodge(width = 1), alpha = 0.7, trim = FALSE) +
  stat_pointinterval(position = position_dodge(width = 1),point_size = 1.5) +
  facet_grid(Relevance ~ Condition) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal(base_size = 14) +
  labs(subtitle ="Study 1", x = "Gender",y = "Arousal",fill = " Condition Belief")
```

```{r valence 1 model}
m <- readRDS("models/ZOIB/ModelValence_1_ZOIB.rds")

params_table(m)
summary(m, robust = TRUE)
performance::performance(m)
```


### Interindividual Variability
::: {.panel-tabset}

#### Random effects
```{r valence d_vour}
m <- modelbased::estimate_grouplevel(m)
table_dvour(m)
```

#### Participant effects 

```{r valence ppt effects}
colors <- c("Intercept" = "#9C27B0", "ConditionAIGenerated" = "#FF9800")

p_dvour <- m |> 
   mutate(Group = fct_relevel(Group, "Participant", "Item"),
          Parameter = fct_relevel(Parameter, "Intercept", "ConditionAIGenerated")) |>
  ggplot(aes(x = Median , y = Level)) +
  geom_pointrange(aes(xmin = CI_low, xmax = CI_high, color = Parameter), linewidth = 0.3, size = 0.05) +
  facet_grid(Group~Parameter, scales = "free", switch="both") +
  ggside::ggside(scales  = "free") +
  ggside::geom_xsidedensity(aes(group = Parameter, fill = Parameter), color = NA) +
  ggside::ggside(scales  = "free") +
  scale_color_manual(values = colors) +
  scale_fill_manual(values = colors) +
  theme_minimal() +
  theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        strip.placement.x = "outside",
        strip.background = element_rect(fill = NA, color = NA),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(),
        legend.position = "none")
p_dvour
```
:::

### Correlations (moderators)

```{r valence 1 corr}

correlations <- df1 |>
  select(Participant, starts_with("Feedback"), starts_with("BAIT"), starts_with("GAIS"), starts_with("Porn"), "AI_Knowledge", "SexualActivity_num", "COPS_Frequency_2")

features1 <- reshape_grouplevel(m, indices = "Median", group = "Participant") |> 
  datawizard::data_addprefix("ZOIB_", exclude = "Participant") |>
  full_join(correlations, by = "Participant") 
  

cordata <- correlation::correlation(select(features1, -Participant), p_adjust = "none", redundant = TRUE) |> 
  correlation::cor_sort() |> 
  correlation::cor_lower() |>
  as.data.frame()

p2_cor <- cordata |> 
  ggplot(aes(x=Parameter2, y = Parameter1)) +
  geom_tile(aes(fill = r)) +
  geom_text(aes(label = insight::format_value(r, 2, zap_small = TRUE, lead_zero = FALSE)), color = ifelse(cordata$p < 0.01, "black", "grey")) +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.position = "none"
  )
p2_cor

```

# Study 2

## Rate Belief

```{r ratebelief 2}

rate2 <- table(df2$Feedback_AllReal)["True"] / sum(table(df2$Feedback_AllReal))
```

In study 2 (i.e., gave feedback that all images were real images) was `r round(mean(rate2) * 100, 1)`%. 

## Arousal

### Manipulation Checks
::: {.panel-tabset}

#### Distributions

```{r dist arousal 2}
#| fig-width: 12
arousal_dist2 <- df2 |>
  ggplot(aes(x=Arousal, fill = Condition)) +
  geom_bar(position = "identity", alpha = 0.5, colour = "black") +
  scale_y_sqrt(expand = c(0, 0)) +
  scale_x_continuous(breaks = c(0, 1)) +
  labs(title = "Arousal Study 2", ) +
  facet_wrap(~Gender) +
  scale_fill_manual(values=c("AIGenerated"="#2196F3", "Photograph"="#F44336")) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))

arousal_dist2
```

#### Averages 

```{r arousal 2 t_test}
#| message: false

dfsub2 <- dfsub2 |>
  right_join(
    df2|>
      group_by(Participant, Condition)|>
      summarise(mean_arousal = mean(Arousal, na.rm = TRUE), .groups = "drop") |>
      pivot_wider(names_from = Condition, 
                  names_prefix = "mean_Arousal_", 
                  values_from = mean_arousal) |>
      mutate(diff_arousal = `mean_Arousal_AIGenerated` - mean_Arousal_Photograph)
  )

ttest2 <- stats::t.test(diff_arousal ~ Feedback_AILessArousing, data = dfsub2)
```

```{r arousal 2 diff plot}
diff_plot2 <- dfsub2 |> 
  ggplot(aes(x = Feedback_AILessArousing, y = diff_arousal, fill = Feedback_AILessArousing)) +
  geom_boxplot(width = 0.4, alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.1, size = 1) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 2, fill = "black") +
  labs(
    title = "Study 2",
    x = "Participant said AI is less arousing",
    y = "Arousal Difference (AI - Photo)"
  ) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.position = "none"
  )

diff_plot2
```

**Study 2**: `r report::report(ttest2, data = dfsub2)`
:::

### Effect of Manipulation

```{r arousal 2 by condition belief plot }
df2 |> 
  ggplot(aes(x = Gender, y = Arousal, fill = ConditionBelief)) +
  geom_violin(position = position_dodge(width = 1), alpha = 0.7, trim = FALSE) +
  stat_pointinterval(position = position_dodge(width = 1),point_size = 1.5) +
  facet_grid( ~ Condition) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal(base_size = 14) +
  labs(title = "Arousal by Gender × Belief × Relevance × Condition", subtitle ="Study 2", x = "Gender", y = "Arousal",fill = " Condition Belief")

```

```{r arousal 2 model}
m <- readRDS("models/ZOIB/ModelArousal_2_ZOIB.rds")

params_table(m)
summary(m, robust = TRUE)
performance::performance(m)
```


### Interindividual Variability

::: {.panel-tabset}

#### Random effects
```{r arousal 2 d_vour}
m <- modelbased::estimate_grouplevel(m)
table_dvour(m)
```

#### Participant effects 

```{r arousal 2 ppt effects}
colors <- c("Intercept" = "#9C27B0", "ConditionAIGenerated" = "#FF9800")

p2_dvour <- m |> 
   mutate(Group = fct_relevel(Group, "Participant", "Item"),
          Parameter = fct_relevel(Parameter, "Intercept", "ConditionAIGenerated")) |>
  ggplot(aes(x = Median , y = Level)) +
  geom_pointrange(aes(xmin = CI_low, xmax = CI_high, color = Parameter), linewidth = 0.3, size = 0.05) +
  facet_grid(Group~Parameter, scales = "free", switch="both") +
  ggside::ggside(scales  = "free") +
  ggside::geom_xsidedensity(aes(group = Parameter, fill = Parameter), color = NA) +
  ggside::ggside(scales  = "free") +
  scale_color_manual(values = colors) +
  scale_fill_manual(values = colors) +
  theme_minimal() +
  theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        strip.placement.x = "outside",
        strip.background = element_rect(fill = NA, color = NA),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(),
        legend.position = "none")
p2_dvour
```
:::

### Correlations (moderators)

```{r arousal 2 corr}

correlations <- df2 |>
  select(Participant, starts_with("Feedback"), starts_with("BAIT"), "PornFrequency", "AI_Knowledge", "SexualActivity_num", "COPS_Frequency", "AllRealConfidence", "AllFakeConfidence", "Enjoyment")

features1 <- reshape_grouplevel(m, indices = "Median", group = "Participant") |> 
  datawizard::data_addprefix("ZOIB_", exclude = "Participant") |>
  full_join(correlations, by = "Participant") 
  

cordata <- correlation::correlation(select(features1, -Participant), p_adjust = "none", redundant = TRUE) |> 
  correlation::cor_sort() |> 
  correlation::cor_lower() |>
  as.data.frame()

p2_cor <- cordata |> 
  ggplot(aes(x=Parameter2, y = Parameter1)) +
  geom_tile(aes(fill = r)) +
  geom_text(aes(label = insight::format_value(r, 2, zap_small = TRUE, lead_zero = FALSE)), color = ifelse(cordata$p < 0.01, "black", "grey")) +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.position = "none"
  )
p2_cor

``` 

## Enticement

### Manipulation Checks

::: {.panel-tabset}

#### Distributions 

```{r dist enticement 2}
#| fig-width: 12
enticement_dist2 <- df2 |>
  ggplot(aes(x=Enticement, fill = Condition)) +
  geom_bar(position = "identity", alpha = 0.5, colour = "black") +
  scale_y_sqrt(expand = c(0, 0)) +
  scale_x_continuous(breaks = c(0, 1)) +
  labs(title = "Enticment Study 2", ) +
  facet_wrap(~Gender) +
  scale_fill_manual(values=c("Photograph"="#F44336", "AIGenerated"="#2196F3")) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))

enticement_dist2
```

#### Averages 

```{r enticement 2 t_test}
#| message: false

dfsub2 <- dfsub2 |>
  right_join(
    df2|>
      group_by(Participant, Condition)|>
      summarise(mean_Enticement = mean(Enticement, na.rm = TRUE), .groups = "drop") |>
      pivot_wider(names_from = Condition, 
                  names_prefix = "mean_Enticement_", 
                  values_from = mean_Enticement) |>
      mutate(diff_enticement = `mean_Enticement_AIGenerated` - mean_Enticement_Photograph)
  )

ttest2 <- stats::t.test(diff_enticement ~ Feedback_AILessArousing, data = dfsub2)
```

```{r enticement 2 diff plot}
diff_plot2 <- dfsub2 |> 
  ggplot(aes(x = Feedback_AILessArousing, y = diff_enticement, fill = Feedback_AILessArousing)) +
  geom_boxplot(width = 0.4, alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.1, size = 1) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 2, fill = "black") +
  labs(
    title = "Study 2",
    x = "Participant said AI is less arousing",
    y = "Enticement Difference (AI - Photo)"
  ) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.position = "none"
  )

diff_plot2
```

**Study 2**: `r report::report(ttest2, data = dfsub1)`

:::

### Effect of Manipulation

```{r enticement 2 by condition belief plot }
df2 |> 
  ggplot(aes(x = Gender, y = Enticement, fill = ConditionBelief)) +
  geom_violin(position = position_dodge(width = 1), alpha = 0.7, trim = FALSE) +
  stat_pointinterval(position = position_dodge(width = 1),point_size = 1.5) +
  facet_grid( ~ Condition) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal(base_size = 14) +
  labs(title = "Enticement by Gender × Belief × Relevance × Condition", subtitle ="Study 2", x = "Gender", y = "Enticement",fill = " Condition Belief")

```

```{r enticement 2 model}
m <- readRDS("models/ZOIB/ModelEnticement_2_ZOIB.rds")

params_table(m)
summary(m, robust = TRUE)
performance::performance(m)
```


### Interindividual Variability
::: {.panel-tabset}

#### Random effects
```{r enticement 2  d_vour}
m <- modelbased::estimate_grouplevel(m)
table_dvour(m)
```

#### Participant effects 

```{r enticement 2 ppt effects}
colors <- c("Intercept" = "#9C27B0", "ConditionAIGenerated" = "#FF9800")

p_dvour <- m |> 
   mutate(Group = fct_relevel(Group, "Participant", "Item"),
          Parameter = fct_relevel(Parameter, "Intercept", "ConditionAIGenerated")) |>
  ggplot(aes(x = Median , y = Level)) +
  geom_pointrange(aes(xmin = CI_low, xmax = CI_high, color = Parameter), linewidth = 0.3, size = 0.05) +
  facet_grid(Group~Parameter, scales = "free", switch="both") +
  ggside::ggside(scales  = "free") +
  ggside::geom_xsidedensity(aes(group = Parameter, fill = Parameter), color = NA) +
  ggside::ggside(scales  = "free") +
  scale_color_manual(values = colors) +
  scale_fill_manual(values = colors) +
  theme_minimal() +
  theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        strip.placement.x = "outside",
        strip.background = element_rect(fill = NA, color = NA),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(),
        legend.position = "none")
p_dvour
```

:::

### Correlations (moderators)

```{r enticement 2 corr}

correlations <- df2 |>
  select(Participant, starts_with("Feedback"), starts_with("BAIT"), "PornFrequency", "AI_Knowledge", "SexualActivity_num","COPS_Frequency", "AllRealConfidence", "AllFakeConfidence", "Enjoyment")

features1 <- reshape_grouplevel(m, indices = "Median", group = "Participant") |> 
  datawizard::data_addprefix("ZOIB_", exclude = "Participant") |>
  full_join(correlations, by = "Participant") 
  

cordata <- correlation::correlation(select(features1, -Participant), p_adjust = "none", redundant = TRUE) |> 
  correlation::cor_sort() |> 
  correlation::cor_lower() |>
  as.data.frame()

p2_cor <- cordata |> 
  ggplot(aes(x=Parameter2, y = Parameter1)) +
  geom_tile(aes(fill = r)) +
  geom_text(aes(label = insight::format_value(r, 2, zap_small = TRUE, lead_zero = FALSE)), color = ifelse(cordata$p < 0.01, "black", "grey")) +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.position = "none"
  )
p2_cor

```  

## Valence

### Manipulation Checks

::: {.panel-tabset}

#### Distributions

```{r dist valence 2}
#| fig-width: 12
valence_dist2 <- df2 |>
  ggplot(aes(x=Valence, fill = Condition)) +
  geom_bar(position = "identity", alpha = 0.5, colour = "black") +
  scale_y_sqrt(expand = c(0, 0)) +
  scale_x_continuous(breaks = c(0, 1)) +
  labs(title = "Valence Study 2", ) +
  facet_wrap(~Gender) +
  scale_fill_manual(values=c("Photograph"="#F44336", "AIGenerated"="#2196F3")) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))

valence_dist2
```

#### Averages 

```{r valence 2 t_test}
#| message: false

dfsub2 <- dfsub2 |>
  right_join(
    df2|>
      group_by(Participant, Condition)|>
      summarise(mean_Valence = mean(Valence, na.rm = TRUE), .groups = "drop") |>
      pivot_wider(names_from = Condition, 
                  names_prefix = "mean_Valence_", 
                  values_from = mean_Valence) |>
      mutate(diff_valence = `mean_Valence_AIGenerated` - mean_Valence_Photograph)
  )

ttest2 <- stats::t.test(diff_valence ~ Feedback_AILessArousing, data = dfsub2)
```

```{r valence 2 diff plot}
diff_plot2 <- dfsub2 |> 
  ggplot(aes(x = Feedback_AILessArousing, y = diff_valence, fill = Feedback_AILessArousing)) +
  geom_boxplot(width = 0.4, alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.1, size = 1) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 2, fill = "black") +
  labs(
    title = "Study 2",
    x = "Participant said AI is less arousing",
    y = "Valence Difference (AI - Photo)"
  ) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.position = "none"
  )

diff_plot2
```

**Study 2**: `r report::report(ttest2, data = dfsub2)`

:::

### Effect of Manipulation

```{r valence 2 by condition belief plot }
df2 |> 
  ggplot(aes(x = Gender, y = Valence, fill = ConditionBelief)) +
  geom_violin(position = position_dodge(width = 1), alpha = 0.7, trim = FALSE) +
  stat_pointinterval(position = position_dodge(width = 1),point_size = 1.5) +
  facet_grid( ~ Condition) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal(base_size = 14) +
  labs(title = "Valence by Gender × Belief × Relevance × Condition", subtitle ="Study 2", x = "Gender", y = "valence",fill = " Condition Belief")
```

```{r valence 2 model}
m <- readRDS("models/ZOIB/ModelValence_2_ZOIB.rds")

params_table(m)
summary(m, robust = TRUE)
performance::performance(m)
```


### Interindividual Variability

::: {.panel-tabset}

#### Random effects
```{r valence 2 d_vour}
m <- modelbased::estimate_grouplevel(m)
table_dvour(m)
```

#### Participant effects 

```{r valence 2 ppt effects}
colors <- c("Intercept" = "#9C27B0", "ConditionAIGenerated" = "#FF9800")

p_dvour <- m |> 
   mutate(Group = fct_relevel(Group, "Participant", "Item"),
          Parameter = fct_relevel(Parameter, "Intercept", "ConditionAIGenerated")) |>
  ggplot(aes(x = Median , y = Level)) +
  geom_pointrange(aes(xmin = CI_low, xmax = CI_high, color = Parameter), linewidth = 0.3, size = 0.05) +
  facet_grid(Group~Parameter, scales = "free", switch="both") +
  ggside::ggside(scales  = "free") +
  ggside::geom_xsidedensity(aes(group = Parameter, fill = Parameter), color = NA) +
  ggside::ggside(scales  = "free") +
  scale_color_manual(values = colors) +
  scale_fill_manual(values = colors) +
  theme_minimal() +
  theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        strip.placement.x = "outside",
        strip.background = element_rect(fill = NA, color = NA),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(),
        legend.position = "none")
p_dvour
```
:::

### Correlations (moderators)

```{r valence 2 corr}

correlations <- df2 |>
  select(Participant, starts_with("Feedback"), starts_with("BAIT"), "PornFrequency", "AI_Knowledge", "SexualActivity_num", "COPS_Frequency", "AllRealConfidence", "AllFakeConfidence", "Enjoyment")

features1 <- reshape_grouplevel(m, indices = "Median", group = "Participant") |> 
  datawizard::data_addprefix("ZOIB_", exclude = "Participant") |>
  full_join(correlations, by = "Participant") 
  

cordata <- correlation::correlation(select(features1, -Participant), p_adjust = "none", redundant = TRUE) |> 
  correlation::cor_sort() |> 
  correlation::cor_lower() |>
  as.data.frame()

p2_cor <- cordata |> 
  ggplot(aes(x=Parameter2, y = Parameter1)) +
  geom_tile(aes(fill = r)) +
  geom_text(aes(label = insight::format_value(r, 2, zap_small = TRUE, lead_zero = FALSE)), color = ifelse(cordata$p < 0.01, "black", "grey")) +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.position = "none"
  )
p2_cor

``` 
