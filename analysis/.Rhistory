# path for data
path <- "C:/Users/asf25/Box/FakeFace2/data"
# path for data
path <- "C:/Users/asf25/Box/InteroceptionScale/data"
# path for data
path <- "C:/Users/asf25/Box/InteroceptionScale/"
files <- list.files(path, pattern = "*.csv")
alldata <- data.frame()
for (file in files) {
rawdata <- read.csv(paste0(path, "/", file))
# Initialize participant-level data
dat <- rawdata[rawdata$screen == "browser_info", ]
data_ppt <- data.frame(
Participant = dat$participantID,
Recruitment = dat$researcher,
Condition = dat$condition,
Experiment_StartDate = as.POSIXct(paste(dat$date, dat$time), format = "%d/%m/%Y %H:%M:%S"),
Experiment_Duration = rawdata[rawdata$screen == "demographics_debrief", "time_elapsed"] / 1000 / 60,
Browser_Version = paste(dat$browser, dat$browser_version),
Mobile = dat$mobile,
Platform = dat$os,
Screen_Width = dat$screen_width,
Screen_Height = dat$screen_height
)
#  Refresh_Rate = dat$vsync_rate
# Demographics
demog <- jsonlite::fromJSON(rawdata[rawdata$screen == "demographic_questions", ]$response)
demog <- as.data.frame(t(demog))
demog$Education <- ifelse(demog$Education == "other", demog$`Education-Comment`, demog$Education)
demog$`Education-Comment` <- NULL
data_ppt <- cbind(data_ppt, demog)
# Feedback
feedback <- jsonlite::fromJSON(rawdata[rawdata$screen == "experiment_feedback", "response"])
data_ppt$Experiment_Enjoyment <- feedback$Feedback_Enjoyment
data_ppt$Experiment_Feedback <- ifelse(is.null(feedback$Feedback_Text), NA, feedback$Feedback_Text)
# Questionnaire + includes attention checks
quest <- jsonlite::fromJSON(rawdata[rawdata$screen == "intero_questionnaire", "response"])
quest <- as.data.frame(quest)
data_ppt <- cbind(data_ppt, quest)
alldata <- rbind(data_ppt, alldata)
}
demog
# Demographics
demog <- jsonlite::fromJSON(rawdata[rawdata$screen == "demographic_questions", ]$response)
rawdata <- read.csv(paste0(path, "/", file))
files <- list.files(path, pattern = "*.csv")
files
# path for data
path <- "C:/Users/asf25/Box/InteroceptionScale/"
path
files <- list.files(path, pattern = "*.csv")
files
install.packages("apa7.cls")
install.packages("apa7.cls")
tinytex::install_tinytex()
Y
install.packages("papaja")
install.packages("TinyTex")
install.packages("tinytex")
setwd("C:/Users/asf25/Documents/studies/InteroceptionIAS/paper/1_Initial")
setwd("~/")
setwd("~/")
install.packages("apa7.cls")
install.packages("apa7.cls")
setwd("C:/Users/asf25/Desktop/studies/FictionEro/analysis")
# Chunk 1: libraries
#| message: false
#| warning: false
library(dplyr)
library(tidyverse)
library(easystats)
library(patchwork)
library(ggside)
library(gt)
library(ggdist)
library(posterior)
library(forcats)
options(mc.cores = parallel::detectCores(),
brms.backend = "cmdstanr",
width = 300)
# Chunk 2: functions
results_table <- function(model, effects="fixed", filter=NULL) {
if("marginaleffects" %in% class(model)) {
model |>
parameters::parameters() |>
as.data.frame() |>
select(-Parameter, -SE, -S, z=Statistic) |>
insight::format_table() |>
parameters::display()
} else {
display(parameters::parameters(model, effects=effects, keep=filter))
}
}
# Parameters tables for the models
params_table <- function(m) {
# d <- as.data.frame(m, variable = insight::find_parameters(m, effects = "fixed", flatten  = TRUE))
t <- bayestestR::describe_posterior(m, effects = "fixed", component = "all", ci_method = "hdi", test = "p_direction")
out <- insight::format_table(t)
out |>
mutate(col = t$pd) |>
gt::gt() |>
gt::data_color(columns = "col", method = "numeric", target_columns = "pd",
row = col > 0.95, palette = "yellow") |>
gt::data_color(columns = "col", method = "numeric", target_columns = "pd",
row = col > 0.97, palette = "green") |>
gt::cols_hide("col")
}
# Random effects table
table_dvour <- function(g) {
performance::performance_dvour(g) |>
arrange(desc(D_vour)) |>
gt::gt() |>
gt::data_color("D_vour", palette = c("red","green"), domain = c(0, 1)) |>
gt::fmt_auto()
}
## plot for participant effects
p_dvour <- function(m, colors){
m |>
mutate(
Group = fct_relevel(Group, "Participant", "Item")) |>
ggplot(aes(x = Median , y = Level)) +
geom_pointrange(
aes(xmin = CI_low, xmax = CI_high, color = Parameter),
linewidth = 0.3, size = 0.05
) +
facet_grid(Group ~ Parameter, scales = "free", switch = "both") +
ggside::ggside(scales = "free") +
ggside::geom_xsidedensity(aes(fill = Parameter), color = NA) +
scale_x_continuous(limits = c(-4, 4), breaks = seq(-4, 4, 1)) +
scale_color_manual(values = colors) +
scale_fill_manual(values = colors) +
theme_minimal() +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.placement.x = "outside",
strip.background = element_rect(fill = NA, color = NA),
axis.title = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
axis.text.x = element_text(hjust = 1),
legend.position = "none")
}
# Chunk 3: data study1
#| warning: false
dfsub1 <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study1/data/data_participants.csv")
df1 <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study1/data/data.csv") |>
right_join(
select(dfsub1, Participant, Sample, Language, Mobile, starts_with("Feedback_"),
BAIT_Visual, BAIT_Text, AI_Knowledge, SexualActivity,
GAAIS_Negative, GAAIS_Positive, Porn, COPS_Frequency_2,
Screen_Size,
-Feedback_Comments),
by = "Participant") |>
rename(Gender = Sex) |>
datawizard::rescale(select=c("Valence"), range=c(-1, 1), to=c(0, 1)) |>
mutate(Condition = fct_recode(Condition, "Photograph" = "Photograph", "AIGenerated" = "AI-Generated"),
Condition = fct_relevel(Condition, "Photograph", "AIGenerated"),
Relevance = fct_recode(Relevance,  "Relevant" = "Relevant",  "Irrelevant"= "Irrelevant", "NonErotic" = "Non-erotic"),
Relevance =  fct_relevel(Relevance, "Relevant", "Irrelevant", "NonErotic"),
Gender =  fct_relevel(Gender, "Male", "Female"),
ConditionBelief = case_when(
Condition == "Photograph" & Realness > 0.5 ~ "True",
Condition == "AIGenerated" & Realness < 0.5 ~ "True",
.default = "False"),
ConditionBelief = as.factor(ConditionBelief),
ConditionBelief = fct_relevel(ConditionBelief, "True", "False"),
PornFrequency = as.numeric(as.factor(COPS_Frequency_2)),
SexualActivity_num = as.numeric(as.factor(SexualActivity)),
across(starts_with("Feedback_"), function(x) {fct_relevel(x, "False", "True")}))
# Chunk 4: data study2
#| warning: false
dfsub2 <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study2/data/data_participants.csv")
df2 <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study2/data/data.csv") |>
right_join(
select(dfsub2, Participant, Mobile, starts_with(c("Feedback_","BAIT")), COPS_Frequency, SexualActivity,- Feedback_Text),
by = "Participant"
) |>
datawizard::rescale(select= c("Arousal", "Enticing", "Valence"), range=c(0, 6), to=c(0,1)) |>
datawizard::rescale(select= c("Realness"), range=c(-3,3), to=c(0,1)) |>
filter(SexualOrientation == "Heterosexual") |> # Keep only heterosexuals
mutate(Gender =  fct_relevel(Gender, "Male", "Female"),
Condition = case_when(
Condition == "Fiction" ~ "AIGenerated",
Condition == "Reality" ~ "Photograph"),
Condition = fct_relevel(Condition, "Photograph", "AIGenerated"),
ConditionBelief = case_when(
Condition == "Photograph" & Realness > 0.5 ~ "True",
Condition == "AIGenerated" & Realness < 0.5 ~ "True",
.default = "False"),
ConditionBelief = as.factor(ConditionBelief),
ConditionBelief = fct_relevel(ConditionBelief, "True", "False"),
PornFrequency = as.numeric(as.factor(COPS_Frequency)),
SexualActivity_num = as.numeric(as.factor(SexualActivity)),
across(starts_with("Feedback_"), as.factor),
across(starts_with("Feedback_"), function(x) {fct_relevel(x, "False", "True")})) |>
rename(Item = Stimulus,
Enticement = Enticing,
AllRealConfidence = "Feedback_AllRealConfidence",
AllFakeConfidence = "Feedback_AllFakeConfidence",
Enjoyment = "Feedback_Enjoyment")
# Chunk 5: ratebelief 1
rate1 <- table(df1$Feedback_LabelsIncorrect)["True"] / sum(table(df1$Feedback_LabelsIncorrect))
# Chunk 6: dist arousal 1
#| fig-width: 12
arousal_dist1 <- df1 |>
ggplot(aes(x=Arousal, fill = Condition)) +
geom_histogram(position = "identity", alpha = 0.5, colour = "black", bins = 30) +
scale_x_continuous(breaks = c(0, 1)) +
labs(title = "Arousal Study 1", ) +
facet_wrap(~Gender) +
scale_fill_manual(values=c("AIGenerated"="#2196F3", "Photograph"="#F44336")) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face="bold"))
arousal_dist1
# Chunk 7: arousal 1 t_test
#| message: false
dfsub1_arousal <- dfsub1 |>
right_join(
df1 |>
group_by(Participant, Condition) |>
summarise(mean_arousal = mean(Arousal, na.rm = TRUE), .groups = "drop") |>
pivot_wider(
names_from = Condition,
names_prefix = "mean_Arousal_",
values_from = mean_arousal
) |>
mutate(diff_arousal = `mean_Arousal_AIGenerated` - mean_Arousal_Photograph)
)
ttest1 <- stats::t.test(diff_arousal ~ Feedback_AILessArousing, data = dfsub1_arousal)
# Chunk 8: arousal 1 diff plot
diff_plot1 <- dfsub1_arousal |>
ggplot(aes(x = Feedback_AILessArousing, y = diff_arousal, fill = Feedback_AILessArousing)) +
geom_boxplot(width = 0.4,alpha = 0.7) +
geom_jitter(width = 0.2, alpha = 0.1, size = 1) +
stat_summary(fun = mean, geom = "point", shape = 23, size = 2, fill = "black") +
labs(
title = "Study 1",
x = "Participant said AI is less arousing",
y = "Arousal Difference (AI - Photo)"
) +
scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = "none"
)
diff_plot1
# Chunk 9: arousal 1 by condition belief plot
df1 |>
ggplot(aes(x = Gender, y = Arousal, fill = ConditionBelief)) +
geom_violin(position = position_dodge(width = 1), alpha = 0.7, trim = FALSE) +
stat_pointinterval(position = position_dodge(width = 1),point_size = 1.5) +
facet_grid(Relevance ~ Condition) +
scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
theme_minimal(base_size = 14) +
labs(subtitle ="Study 1", x = "Gender",y = "Arousal",fill = "Condition Belief")
# Chunk 10: arousal 1 model load
#| cache: false
m <- readRDS("models/ZOIB/ModelArousal_1_ZOIB.rds")
correlations <- df1 |>
select(Participant, starts_with("Feedback"), starts_with("BAIT"), starts_with("GAIS"), starts_with("Porn"), "AI_Knowledge", "SexualActivity_num", "COPS_Frequency_2")
corr_mod <- function(m, correlations){
features1 <- reshape_grouplevel(m, indices = "Median", group = "Participant") |>
full_join(correlations, by = "Participant")
cordata <- correlation::correlation(select(features1, -Participant), p_adjust = "none", redundant = TRUE) |>
correlation::cor_sort() |>
correlation::cor_lower() |>
as.data.frame() |>
mutate(Parameter2 = fct_rev(Parameter2),
Parameter1 = fct_relabel(Parameter1, \(x) gsub("_Intercept", "", x)),
Parameter2 = fct_relabel(Parameter2, \(x) gsub("_Intercept", "", x)),
Parameter1 = fct_relabel(Parameter1, \(x) gsub("_", " - ", x)),
Parameter2 = fct_relabel(Parameter2, \(x) gsub("_", " - ", x)))
p2_cor <- cordata |>
ggplot(aes(x=Parameter2, y = Parameter1)) +
geom_tile(aes(fill = r)) +
geom_text(aes(label = insight::format_value(r, 2, zap_small = TRUE, lead_zero = FALSE)), color = ifelse(cordata$p < 0.01, "black", "grey")) +
scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none"
)
p2_cor
}
corr_mod(m, correlations)
m <- modelbased::estimate_grouplevel(m)
table_dvour(m)
names(df1)
correlations <- df1 |>
select(Participant, starts_with("Feedback"), starts_with("BAIT"), starts_with("GAAIS"), starts_with("Porn"), "AI_Knowledge", "SexualActivity_num", "COPS_Frequency_2")
corr_mod <- function(m, correlations){
features1 <- reshape_grouplevel(m, indices = "Median", group = "Participant") |>
full_join(correlations, by = "Participant")
cordata <- correlation::correlation(select(features1, -Participant), p_adjust = "none", redundant = TRUE) |>
correlation::cor_sort() |>
correlation::cor_lower() |>
as.data.frame() |>
mutate(Parameter2 = fct_rev(Parameter2),
Parameter1 = fct_relabel(Parameter1, \(x) gsub("_Intercept", "", x)),
Parameter2 = fct_relabel(Parameter2, \(x) gsub("_Intercept", "", x)),
Parameter1 = fct_relabel(Parameter1, \(x) gsub("_", " - ", x)),
Parameter2 = fct_relabel(Parameter2, \(x) gsub("_", " - ", x)))
p2_cor <- cordata |>
ggplot(aes(x=Parameter2, y = Parameter1)) +
geom_tile(aes(fill = r)) +
geom_text(aes(label = insight::format_value(r, 2, zap_small = TRUE, lead_zero = FALSE)), color = ifelse(cordata$p < 0.01, "black", "grey")) +
scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none"
)
p2_cor
}
corr_mod(m, correlations)
m <- readRDS("models/ZOIB/ModelEnticement_1_ZOIB.rds")
m <- readRDS("models/ZOIB/ModelArousal_1_ZOIB.rds")
performance::performance_dvour()
?performance_dvour()
