---
title: "FictionEro - Affective Impact of Fiction"
editor: source
editor_options: 
  chunk_output_type: console
format:
  html:
    toc: true
    code-fold: true
    self-contained: false
execute: 
  cache: true
  cache-lazy: false
---


# Data Preparation

```{r libraries}
#| message: false
#| warning: false

library(dplyr)
library(tidyverse)
library(easystats)
library(patchwork)
library(ggside)
library(gt)
library(ggdist)
library(posterior)
library(forcats)

options(mc.cores = parallel::detectCores(),
        brms.backend = "cmdstanr",
        width = 300)
```

```{r functions}

results_table <- function(model, effects="fixed", filter=NULL) {
  if("marginaleffects" %in% class(model)) {
    model |> 
      parameters::parameters() |> 
      as.data.frame() |> 
      select(-Parameter, -SE, -S, z=Statistic) |> 
      insight::format_table() |> 
      parameters::display()
  } else {
    display(parameters::parameters(model, effects=effects, keep=filter))
  }
}

# Parameters tables for the models 
params_table <- function(m) {
  # d <- as.data.frame(m, variable = insight::find_parameters(m, effects = "fixed", flatten  = TRUE))
  t <- bayestestR::describe_posterior(m, effects = "fixed", component = "all", ci_method = "hdi", test = "p_direction")
  out <- insight::format_table(t)
  out |> 
    mutate(col = t$pd) |> 
    gt::gt() |> 
    gt::data_color(columns = "col", method = "numeric", target_columns = "pd", 
                   row = col > 0.95, palette = "yellow") |> 
    gt::data_color(columns = "col", method = "numeric", target_columns = "pd", 
                   row = col > 0.97, palette = "green") |> 
    gt::cols_hide("col")
}

# Random effects table
table_dvour <- function(g) {
  performance::performance_dvour(g) |> 
    arrange(desc(D_vour)) |> 
    gt::gt() |> 
    gt::data_color("D_vour", palette = c("red","green"), domain = c(0, 1)) |> 
    gt::fmt_auto()
}

```

```{r data study1}
#| message: false
#| warning: false

dfsub1 <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study1/data/data_participants.csv")
df1 <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study1/data/data.csv") |> 
  right_join(
    select(dfsub1, Participant, Sample, Language, Mobile, starts_with("Feedback_"), 
           BAIT_Visual, BAIT_Text, AI_Knowledge, SexualActivity, 
           GAAIS_Negative, GAAIS_Positive, Porn, COPS_Frequency_2,
           Screen_Size,
           -Feedback_Comments),
    by = "Participant") |> 
  rename(Gender = Sex) |>
  datawizard::rescale(select=c("Valence"), range=c(-1, 1), to=c(0, 1)) |> 
  mutate(Condition = fct_recode(Condition, "Photograph" = "Photograph", "AIGenerated" = "AI-Generated"),
         Condition = fct_relevel(Condition, "Photograph", "AIGenerated"),
         Relevance = fct_recode(Relevance,  "Relevant" = "Relevant",  "Irrelevant"= "Irrelevant", "NonErotic" = "Non-erotic"),
         Relevance =  fct_relevel(Relevance, "Relevant", "Irrelevant", "NonErotic"),
         Gender =  fct_relevel(Gender, "Male", "Female"),
         ConditionBelief = case_when(
           Condition == "Photograph" & Realness > 0.5 ~ "True",
           Condition == "AIGenerated" & Realness < 0.5 ~ "True",
           .default = "False"),
         ConditionBelief = as.factor(ConditionBelief),
         ConditionBelief = fct_relevel(ConditionBelief, "True", "False"),
         PornFrequency = as.numeric(as.factor(COPS_Frequency_2)),
         SexualActivity_num = as.numeric(as.factor(SexualActivity)),
         across(starts_with("Feedback_"), function(x) {fct_relevel(x, "False", "True")}))
```

```{r data study2}
#| message: false
#| warning: false

dfsub2 <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study2/data/data_participants.csv")
df2 <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study2/data/data.csv") |> 
  right_join(
    select(dfsub2, Participant, Mobile, starts_with(c("Feedback_","BAIT")), COPS_Frequency, SexualActivity,- Feedback_Text),
    by = "Participant"
  ) |> 
  datawizard::rescale(select= c("Arousal", "Enticing", "Valence"), range=c(0, 6), to=c(0,1)) |>
  datawizard::rescale(select= c("Realness"), range=c(-3,3), to=c(0,1)) |>
  filter(SexualOrientation == "Heterosexual") |> # Keep only heterosexuals
  mutate(Gender =  fct_relevel(Gender, "Male", "Female"),
         Condition = case_when(
           Condition == "Fiction" ~ "AIGenerated",
           Condition == "Reality" ~ "Photograph"), 
         Condition = fct_relevel(Condition, "Photograph", "AIGenerated"),
         ConditionBelief = case_when(
           Condition == "Photograph" & Realness > 0.5 ~ "True",
           Condition == "AIGenerated" & Realness < 0.5 ~ "True",
           .default = "False"),
         ConditionBelief = as.factor(ConditionBelief),
         ConditionBelief = fct_relevel(ConditionBelief, "True", "False"),
         PornFrequency = as.numeric(as.factor(COPS_Frequency)),
         SexualActivity_num = as.numeric(as.factor(SexualActivity)),
         across(starts_with("Feedback_"), as.factor), 
         across(starts_with("Feedback_"), function(x) {fct_relevel(x, "False", "True")})) |>
    rename(Item = Stimulus,
           Enticement = Enticing,
           AllRealConfidence = "Feedback_AllRealConfidence",
           AllFakeConfidence = "Feedback_AllFakeConfidence",
           Enjoyment = "Feedback_Enjoyment") 

## compute based on higher dimensions

df2$BAIT_ImagesIssues <- 6 - df2$BAIT_ImagesIssues
df2$BAIT_VideosIssues <- 6 - df2$BAIT_VideosIssues
df2$BAIT_TextIssues <- 6 - df2$BAIT_TextIssues

df2$BAIT_Dangerous <- 6 - df2$BAIT_Dangerous
df2$BAIT_Worry <- 6 - df2$BAIT_Worry

df2$BAIT_ImageDistinctionBad <- 6 - df2$BAIT_ImageDistinctionBad
df2$BAIT_TextDifferentiation <- 6 - df2$BAIT_TextDifferentiation

df2$BAIT_UniqueHuman <- 6 - df2$BAIT_UniqueHuman
df2$BAIT_ImpersonalAI <- 6 - df2$BAIT_ImpersonalAI
df2$BAIT_EmotionalHuman <- 6 - df2$BAIT_EmotionalHuman
df2$BAIT_PreferenceHuman <- 6 - df2$BAIT_PreferenceHuman
df2$BAIT_TrustHuman <- 6 - df2$BAIT_TrustHuman


df2$BAIT_Expectations <- rowMeans(select(df2, BAIT_ImagesRealistic, BAIT_ImagesIssues,  BAIT_VideosIssues, BAIT_TextIssues, BAIT_VideosRealistic, BAIT_TextRealistic, BAIT_EnvironmentReal, BAIT_ImitatingReality), na.rm=TRUE)

df2$BAIT_Attitudes <- rowMeans(select(df2,BAIT_Worry, BAIT_Exciting, BAIT_Dangerous, BAIT_Benefit), na.rm=TRUE)

df2$BAIT_Expertise <- rowMeans(select(df2, BAIT_UserAI, BAIT_UnderstandingAI, BAIT_ExpertAI), na.rm=TRUE)

df2$BAIT_Discrimination <- rowMeans(select(df2,BAIT_ImageDistinctionEasy, BAIT_ImageDistinctionBad, BAIT_TextDifferentiation, BAIT_ContentDetection), na.rm=TRUE)

df2$BAIT_Bias <- rowMeans(select(df2,BAIT_InnovativeAI, BAIT_UniqueHuman, BAIT_EmotionalHuman, BAIT_InterestingAI, BAIT_TrustHuman, BAIT_ImpersonalAI, BAIT_PreferenceHuman), na.rm=TRUE)


df2$BAIT_Total <- rowMeans(select(df2, BAIT_Expectations, BAIT_Attitudes, BAIT_Expertise, BAIT_Discrimination, BAIT_Bias), na.rm=TRUE)
```

## Internal Consistency
::: {.panel-tabset}

### Study 1

```{r}
#| message: false
#| warning: false

GAAIS_Negative <- dfsub1[grepl("^GAAIS_Negative_", names(dfsub1))]
GAAIS_Positive <- dfsub1[grepl("^GAAIS_Positive_", names(dfsub1))]

GAAIS_Negative_o <- psych::omega(GAAIS_Negative, n_factors= 1)
GAAIS_Positive_o <- psych::omega(GAAIS_Positive, n_factors= 1)

```

McDonald's Omega (\(\omega \)) total was aceptable for both dimensions of the GAAIS (Negative = `r round(GAAIS_Negative_o$omega.tot,2)`, and Positive = `r round(GAAIS_Positive_o$omega.tot,2)`). 

```{r}
#| message: false
#| warning: false


dfsub1$BAIT_8_TextIssues <- 1- dfsub1$BAIT_8_TextIssues
dfsub1$BAIT_2_ImagesIssues <- 1- dfsub1$BAIT_2_ImagesIssues
dfsub1$BAIT_4_VideosIssues <- 1- dfsub1$BAIT_4_VideosIssues
# dfsub1$BAIT_5_ImitatingReality <- dfsub1$BAIT_5_ImitatingReality


BAIT_Text <- dfsub1[, grepl("^BAIT_[78]_Text", names(dfsub1))]
BAIT_Images <- dfsub1[, grepl("^BAIT_[12]_Images", names(dfsub1))]
BAIT_Videos <- dfsub1[,grepl("^BAIT_[34]_Videos", names(dfsub1))]
BAIT_Enviornment <-dfsub1[, grepl("^BAIT_[56]", names(dfsub1))]

BAIT_Text_a <- psych::alpha(BAIT_Text)
BAIT_Images_a <- psych::alpha(BAIT_Images)
BAIT_Videos_a <- psych::alpha(BAIT_Videos)
BAIT_Enviornment_a <- psych::alpha(BAIT_Enviornment)
```

Cronbach's alpha (\(\alpha\)) was questionnable for the Text dimension (`r round(BAIT_Text_a$total$raw_alpha,2)`), very poor for the Images dimension ( `r round(BAIT_Images_a$total$raw_alpha, 2)`), poor for the Videos `r round(BAIT_Videos_a$total$raw_alpha, 2)`) and poor for the Enviornment dimensions (`r round(BAIT_Enviornment_a$total$raw_alpha, 2)`).

```{r}
dfsub1 <- dfsub1 |>
  mutate(COPS_Duration_1 = case_when(
    COPS_Duration_1 =="1. Less than 5 minutes" ~ 1,
    COPS_Duration_1 == "2. 6-15 minutes" ~2, 
    COPS_Duration_1 =="3. 16-25 minutes" ~3, 
    COPS_Duration_1 == "4. 26-35 minutes" ~ 4,
    COPS_Duration_1 == "5. 36-45 minutes" ~5, 
    COPS_Duration_1 == "6. 46+ minutes" ~ 6),
    COPS_Frequency_2 = case_when(
    COPS_Frequency_2 == "0. I haven't viewed pornography in the past 30 days" ~ 0, 
    COPS_Frequency_2 =="1. I viewed pornography once in the past 30 days" ~ 1,
    COPS_Frequency_2 == "2. I viewed pornography twice in the past 30 days" ~2, 
    COPS_Frequency_2 =="3. I viewed pornography weekly" ~3, 
    COPS_Frequency_2 == "4. I viewed pornography multiple times a week " ~ 4,
    COPS_Frequency_2 == " 5. I viewed pornography daily" ~5, 
    COPS_Frequency_2 == "6. I viewed pornography multiple times a day" ~ 6),
    SexualActivity = case_when(
      SexualActivity == "1. Less than 24h ago" ~ 1 , 
      SexualActivity == "2. Within the last 3 days" ~ 2, 
      SexualActivity == "3. Within the last week" ~ 3,
      SexualActivity == "4. Within the last month" ~ 4, 
      SexualActivity == "5. Within the last year" ~ 5,
      SexualActivity == "6. More than a year ago" ~ 5)
    )

COPS <- select(dfsub1, starts_with("COPS_Frequency_"), starts_with("COPS_Duration_1"), "SexualActivity")

COPS_o <- psych::omega(COPS, nfactors = 1)
```

McDonald's Omega (\(\omega \)) total was poor for the COPS `r round(COPS_o$omega.tot,2)`). 

### Study 2
```{r}
#| message: false
#| warning: false

## compute based on higher dimensions
dfsub2$BAIT_ImagesIssues <- 6 - dfsub2$BAIT_ImagesIssues
dfsub2$BAIT_VideosIssues <- 6 - dfsub2$BAIT_VideosIssues
dfsub2$BAIT_TextIssues <- 6 - dfsub2$BAIT_TextIssues

dfsub2$BAIT_Dangerous <- 6 - dfsub2$BAIT_Dangerous
dfsub2$BAIT_Worry <- 6 - dfsub2$BAIT_Worry

dfsub2$BAIT_ImageDistinctionBad <- 6 - dfsub2$BAIT_ImageDistinctionBad
dfsub2$BAIT_TextDifferentiation <- 6 - dfsub2$BAIT_TextDifferentiation

dfsub2$BAIT_UniqueHuman <- 6 - dfsub2$BAIT_UniqueHuman
dfsub2$BAIT_ImpersonalAI <- 6 - dfsub2$BAIT_ImpersonalAI
dfsub2$BAIT_EmotionalHuman <- 6 - dfsub2$BAIT_EmotionalHuman
dfsub2$BAIT_PreferenceHuman <- 6 - dfsub2$BAIT_PreferenceHuman
dfsub2$BAIT_TrustHuman <- 6 - dfsub2$BAIT_TrustHuman



BAIT_Expectations <- select(dfsub2, c("BAIT_ImagesRealistic", "BAIT_ImagesIssues",  "BAIT_VideosIssues", "BAIT_TextIssues", "BAIT_VideosRealistic", "BAIT_TextRealistic", "BAIT_EnvironmentReal", "BAIT_ImitatingReality"))

BAIT_Attitudes <- select(df2, c("BAIT_Worry", "BAIT_Exciting", "BAIT_Dangerous", "BAIT_Benefit"))

BAIT_Expertise <- select(df2, c("BAIT_UserAI", "BAIT_UnderstandingAI", "BAIT_ExpertAI"))

BAIT_Discrimination <- select(df2,c("BAIT_ImageDistinctionEasy", "BAIT_ImageDistinctionBad", "BAIT_TextDifferentiation", "BAIT_ContentDetection"))

BAIT_Bias <- select(df2,c("BAIT_InnovativeAI", "BAIT_UniqueHuman", "BAIT_EmotionalHuman", "BAIT_InterestingAI", "BAIT_TrustHuman", "BAIT_ImpersonalAI", "BAIT_PreferenceHuman"))

BAIT_Expectations_o <- psych::omega(BAIT_Expectations, nfactors = 1)
BAIT_Attitudes_o <-psych::omega(BAIT_Attitudes, nfactors = 1)
BAIT_Expertise_o <- psych::omega(BAIT_Expertise, nfactors = 1)
BAIT_Discrimination_o <- psych::omega(BAIT_Discrimination, nfactors = 1)
BAIT_Bias_o <- psych::omega(BAIT_Bias, nfactors = 1)
```

McDonald's Omega (\(\omega \)) total was acepptable for all the BAIT dimensions (Expectations about AI = `r round( BAIT_Expectations_o$omega.tot,2)`, Attitudes towards AI = `r round(BAIT_Attitudes_o$omega.tot, 2)`, Expertise about AI = `r round(BAIT_Expertise_o$omega.tot, 2)`, Bias against AI = `r round( BAIT_Bias_o$omega.tot, 2)`), except the Discrimination ability of AI output which showed good internal consistency (`r round( BAIT_Discrimination_o$omega.tot, 2)`).

```{r}
#| message: false
#| warning: false

dfsub2 <- dfsub2 |>
  mutate(COPS_Frequency = case_when(
    COPS_Frequency == "0. I haven't viewed pornography in the past 30 days" ~ 0,
    COPS_Frequency =="1. I viewed pornography once in the past 30 days" ~ 1,
    COPS_Frequency == "2. I viewed pornography twice in the past 30 days" ~2,
    COPS_Frequency =="3. I viewed pornography weekly" ~3,
    COPS_Frequency == "4. I viewed pornography multiple times a week " ~ 4,
    COPS_Frequency == " 5. I viewed pornography daily" ~5,
    COPS_Frequency == "6. I viewed pornography multiple times a day" ~ 6),
    SexualActivity = case_when(
      SexualActivity == "1. Less than 24h ago" ~ 1 ,
      SexualActivity == "2. Within the last 3 days" ~ 2,
      SexualActivity == "3. Within the last week" ~ 3,
      SexualActivity == "4. Within the last month" ~ 4,
      SexualActivity == "5. Within the last year" ~ 5,
      SexualActivity == "6. More than a year ago" ~ 5)
    ) |>
  datawizard::rescale(select= c("COPS_Frequency"), range=c(0,6), to=c(0,1)) |>
  datawizard::rescale(select= c("SexualActivity"), range=c(1,6), to=c(0,1)) 



COPS <- select(dfsub1, starts_with("COPS_Frequency"), starts_with("COPS_Duration"), "SexualActivity")

Cops_o <- psych::omega(COPS, nfactors = 1)
```

McDonald's Omega (\(\omega \)) total was also poor for the COPS `r round(Cops_o$omega.tot,2)`) in study 2. 

:::

# Study 1

## Rate Belief

```{r ratebelief 1}
#| message: false
#| warning: false

rate1 <- table(df1$Feedback_LabelsIncorrect)["True"] / sum(table(df1$Feedback_LabelsIncorrect))
```

The rate of people that did not believe the instructions in study 1 (i.e., gave feedback that the labels were incorrect) was `r round(mean(rate1) * 100, 1)`%.


## Models

::: {.panel-tabset}

### Arousal

#### Manipulation Checks
::: {.panel-tabset}

##### Distributions

<!-- Arousal ratings are heavily skewed towards the lower end of the scale, with a much higher frequency of scores at 0 and a slight increase in the middle of the scale, for both images presented as AI-Generated and Photograph.  -->


```{r dist arousal 1}
#| message: false
#| warning: false
#| fig-width: 12

arousal_dist1 <- df1 |>
  ggplot(aes(x=Arousal, fill = Condition)) +
  geom_histogram(position = "identity", alpha = 0.5, colour = "black", bins = 30) +
  scale_x_continuous(breaks = c(0, 1)) +
  labs(title = "Arousal Study 1", ) +
  facet_wrap(~Gender) +
  scale_fill_manual(values=c("AIGenerated"="#2196F3", "Photograph"="#F44336")) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))


arousal_dist1
```

##### Averages 

<!-- Arousal ratings for AI vs photos are similar overall, with those who said AI is less arousing showing slightly lower (more negative) differences. -->

```{r arousal 1 t_test}
#| message: false
#| warning: false

dfsub1_arousal <- dfsub1 |>
  right_join(
    df1 |>
      group_by(Participant, Condition) |>
      summarise(mean_arousal = mean(Arousal, na.rm = TRUE), .groups = "drop") |>
      pivot_wider(
        names_from = Condition,
        names_prefix = "mean_Arousal_",
        values_from = mean_arousal
      ) |>
      mutate(diff_arousal = `mean_Arousal_AIGenerated` - mean_Arousal_Photograph)
  )

ttest1 <- stats::t.test(diff_arousal ~ Feedback_AILessArousing, data = dfsub1_arousal)
```

```{r arousal 1 diff plot}
#| message: false
#| warning: false
#| fig-width: 12

diff_plot1 <- dfsub1_arousal |> 
  ggplot(aes(x = Feedback_AILessArousing, y = diff_arousal, fill = Feedback_AILessArousing)) +
  geom_boxplot(width = 0.4,alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.1, size = 1) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 2, fill = "black") +
  labs(
    title = "Study 1",
    x = "Participant said AI is less arousing",
    y = "Arousal Difference (AI - Photo)"
  ) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.position = "none"
  )

diff_plot1
```

**Study 1**: `r report::report(ttest1, data = dfsub1_arousal)`
:::

#### Effect of Manipulation

```{r arousal 1 by condition belief plot }
#| message: false
#| warning: false

df1 |> 
  ggplot(aes(x = Gender, y = Arousal, fill = ConditionBelief)) +
  geom_violin(position = position_dodge(width = 1), alpha = 0.7, trim = FALSE) +
  stat_pointinterval(position = position_dodge(width = 1),point_size = 1.5) +
  facet_grid(Relevance ~ Condition) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal(base_size = 14) +
  labs(subtitle ="Study 1", x = "Gender",y = "Arousal",fill = "Congruence")
```

```{r arousal 1 model load}
#| cache: false
 
m <- readRDS("models/ZOIB/ModelArousal_1_ZOIB.rds")
```

<!-- Females reported lower arousal than males. Arousal was highest for relevant images and lowest for non-erotic images, with smaller relevance effects among females. Labeling images as AI-generated was associated with reduced arousal, strongest for relevant content and minimal for non-erotic images (especially among females). -->

<!-- Participants who maintained label congruency across phases reported higher arousal than those who changed labels; this effect was larger for males. Label incongruency showed small positive deviations in some conditions (most notably for AI-labeled relevant images and, to a lesser extent, for irrelevant and non-erotic images) with generally larger deviations among females. -->

```{r arousal 1 model analysis}
#| message: false
#| warning: false

params_table(m)
summary(m, robust = TRUE)
# performance::performance(m)
```

##### Marginal contrasts

<!-- When participants maintained label concistency across phases, photographs were rated as more arousing than AI-generated images, particularly for relevant content. When labels were not maintained, this pattern reversed for relevant images, with AI-generated images rated as more arousing, while effects for irrelevant and non-erotic images were small or uncertain. Gender differences were modest.  -->

```{r arousal est cont}
#| message: false
#| warning: false

estimate_contrasts(m, contrast = "Condition", by=c("Gender", "Relevance", "ConditionBelief"), backend = "emmeans") 
```

```{r arousal 1 model plot}
#| message: false
#| warning: false


pred_a <- modelbased::estimate_means(m, by=c("Gender", "Relevance", "Condition", "ConditionBelief"), backend = "emmeans") |>
  as.data.frame()


pred_a |>
  mutate(Gender = fct_relevel(Gender, "Male", "Female")) |> 
  ggplot(aes(x=Relevance, y=Probability)) +
    geom_hline(yintercept=0, color="darkgrey") +
  geom_line(aes(group=Condition, color=Condition), position = position_dodge(width=0.2), alpha=0.8, linewidth=0.2) +
  geom_pointrange(aes(ymin = CI_low, ymax=CI_high, color=Condition), position = position_dodge(width=0.2), size=0.2) +
  # geom_text(data=stars1, aes(y=y, label=label), hjust=0.5, size=3) +
  # geom_rect(data=data.frame(Type="All trials", Proportion=0.1, Sex=as.factor("Male"), Outcome="Arousal", Relevance="Relevant"), 
            # aes(xmin=0.8, xmax=1.2, ymin=0.5, ymax=0.80), color="#8BC34A", alpha=0) +
  # geom_rect(data=data.frame(Type="All trials", Proportion=0.1, Sex=as.factor("Female"), Outcome="Arousal", Relevance="Relevant"), 
            # aes(xmin=0.8, xmax=1.2, ymin=0.2, ymax=0.5), color="#8BC34A", alpha=0) +
  facet_grid(Gender~ConditionBelief, switch = "y") +
  scale_y_continuous(limits=c(0, 1), labels=scales::percent) +
  scale_color_manual(values=c("AIGenerated"="#2196F3", "Photograph"="#F44336")) +
  theme_minimal() +
    theme(axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        axis.text.y = element_text(size = 8),
        strip.placement = "outside",
        strip.background.x = element_rect(fill=c("lightgrey"), color=NA),
        strip.text.x = element_text(size = 10),
        strip.text.y = element_text(size = 10),
        axis.text.x = element_text(angle=25, hjust=1, vjust=1.1, size=9, color="black"),
        legend.text = element_text(size = 10),
        legend.position = "bottom") +
  labs(color="Images presented as:",
       tag = "A")
```

#### Interindividual Variability
::: {.panel-tabset}

##### Random effects

<!-- Random effects indicate minimal reliable inter-individual in response to the label manipulation (i.e., individual differences in how AI interacts with relevance are not reliable)  -->

```{r arousal 1 d_vour}

m <- modelbased::estimate_grouplevel(m)
table_dvour(m)
```

##### Participant effects 

```{r arousal 1 ppt effects}
#| fig-width: 10
colors <- c(
  "Intercept" = "#9C27B0",                   
  "Irrelevant" = "#1E88E5",   
  "Non-Erotic"  = "#43A047",
  "Relevant:AI-Generated"  = "#E53935",
  "Irrelevant:AI-Generated" = "#00897B",
  "Non-Erotic:AI-Generated" = "#FF9800")

## plot for participant effects
p_dvour <- function(m, colors){
  m |>
    mutate(
      Group = fct_relevel(Group, "Participant", "Item"),
      Parameter = fct_relevel(Parameter, "Intercept", "RelevanceIrrelevant", "RelevanceNonErotic",
"RelevanceRelevant:ConditionAIGenerated",                      "RelevanceIrrelevant:ConditionAIGenerated", "RelevanceNonErotic:ConditionAIGenerated"),
    Parameter = fct_recode(
      Parameter,
      `Non-Erotic:AI-Generated` = "RelevanceNonErotic:ConditionAIGenerated",
      `Relevant:AI-Generated`  = "RelevanceRelevant:ConditionAIGenerated",
      `Irrelevant`            = "RelevanceIrrelevant",
      `Irrelevant:AI-Generated`= "RelevanceIrrelevant:ConditionAIGenerated",
      `Non-Erotic`             = "RelevanceNonErotic"))|>
    ggplot(aes(x = Median , y = Level)) +
    geom_pointrange(
      aes(xmin = CI_low, xmax = CI_high, color = Parameter),
      linewidth = 0.3, size = 0.05
    ) +
    facet_grid(Group ~ Parameter, scales = "free", switch = "both") +
    ggside::ggside(scales = "free") +
    ggside::geom_xsidedensity(aes(fill = Parameter), color = NA) +
    # scale_x_continuous(limits = c(-3, 3), breaks = seq(-3, 3, 1)) +
    scale_color_manual(values = colors) +
    scale_fill_manual(values = colors) +
    theme_minimal() +
    theme(
      axis.text.y = element_blank(),
      axis.ticks.y = element_blank(),
      strip.placement.x = "outside",
      strip.background = element_rect(fill = NA, color = NA),
      axis.title = element_blank(),
      panel.grid.minor = element_blank(),
      panel.grid.major.y = element_blank(),
      axis.text.x = element_text(hjust = 1, size =12 ),
      legend.position = "none")
}
```

```{r arousal ppt effect plot}
p_dvour(m, colors)
```

##### Sample analysis 

```{r arousal 1 sample df}

m_sample <- m |>
  select(Group, Level, Parameter, Median) |>
  filter(Group == "Participant" & Parameter %in% c("Intercept","RelevanceRelevant:ConditionAIGenerated")) |>
  pivot_wider(names_from = "Parameter", values_from = "Median") |>
  select(!Group) |>
  rename("Participant" = "Level") 
  

df <- dfsub1 |>
  left_join(m_sample, by = "Participant") |>
  rename("Gender" = "Sex")
```

```{r arousal 1 sample analysis}

results_table(lm(`RelevanceRelevant:ConditionAIGenerated` ~ Intercept + Sample, data = df))
```

```{r arousal 1 country analysis}
results_table(lm(`RelevanceRelevant:ConditionAIGenerated` ~ Intercept + Country, data = df))
```


:::
#### Correlations (moderators)

<!-- We extracted the random effects and correlated them with other variables in the dataset to look at whether these variables "moderated" the effect of condition. Correlations were overall weak - variability in the intercept and relevance-related parameters was not meaningfully associated with participants’ sexual behaviour or their beliefs and attitudes towards AI.  -->

```{r df 1 corr}

correlations <- df1 |>
  select(Participant, starts_with("BAIT"), starts_with("GAAIS"), starts_with("Porn"), "AI_Knowledge", "SexualActivity_num", "COPS_Frequency_2") |>
  rename(SexualActivity = SexualActivity_num)


corr_mod <- function(m, correlations){
  features1 <- reshape_grouplevel(m, indices = "Median", group = "Participant") |> 
  full_join(correlations, by = "Participant")  |>
  rename(`Non-Erotic:AI-Generated` = `RelevanceNonErotic:ConditionAIGenerated`,
           `Relevant:AI-Generated`= `RelevanceRelevant:ConditionAIGenerated`,
           `Irrelevant` = `RelevanceIrrelevant`,
           `Irrelevant:AI-Generated` = `RelevanceIrrelevant:ConditionAIGenerated`,
           `Non-Erotic` = `RelevanceNonErotic`)
  

  cordata <- correlation::correlation(select(features1, -Participant), p_adjust = "none", redundant = TRUE) |> 
    correlation::cor_sort() |>
    correlation::cor_lower() |>
    as.data.frame() |>
      mutate(Parameter2 = fct_rev(Parameter2),
         Parameter1 = fct_relabel(Parameter1, \(x) gsub("_Intercept", "", x)),
         Parameter2 = fct_relabel(Parameter2, \(x) gsub("_Intercept", "", x)),
         Parameter1 = fct_relabel(Parameter1, \(x) gsub("_", " - ", x)),
         Parameter2 = fct_relabel(Parameter2, \(x) gsub("_", " - ", x)))
  
  p2_cor <- cordata |> 
    ggplot(aes(x=Parameter2, y = Parameter1)) +
    geom_tile(aes(fill = r)) +
    geom_text(aes(label = insight::format_value(r, 2, zap_small = TRUE, lead_zero = FALSE)), color = ifelse(cordata$p < 0.01, "black", "grey")) +
    scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
    theme_minimal() +
    theme(
      axis.text.x = element_text(angle = 45, hjust = 1),
      axis.title.x = element_blank(),
      axis.title.y = element_blank(),
      legend.position = "none"
    )
  p2_cor
  
}

```

```{r arousal 1 corr}

corr_mod(m, correlations)

```

### Enticement

#### Manipulation Checks

::: {.panel-tabset}

##### Distributions 

<!-- Like in Arousal, Enticing ratings are heavily skewed towards the lower end of the scal and a slight increase in the middle of the scale. -->


```{r dist enticement 1}
#| fig-width: 12
enticement_dist1 <- df1 |>
  ggplot(aes(x=Enticement, fill = Condition)) +
  geom_histogram(position = "identity", alpha = 0.5, colour = "black", bins = 30) +
  scale_x_continuous(breaks = c(0, 1)) +
  labs(title = "Enticement Study 1", ) +
  facet_wrap(~Gender) +
  scale_fill_manual(values=c("AIGenerated"="#2196F3", "Photograph"="#F44336")) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))


enticement_dist1
```

##### Averages 

<!-- Enticement ratings for AI vs photos are similar overall, with those who said AI is less arousing showing slightly lower (more negative) differences. -->

```{r enticement 1 t_test}
#| message: false

dfsub1_enticement <- dfsub1 |>
  right_join(
    df1 |>
      group_by(Participant, Condition) |>
      summarise(mean_Enticement = mean(Enticement, na.rm = TRUE), .groups = "drop") |>
      pivot_wider(
        names_from = Condition,
        names_prefix = "mean_Enticement_",
        values_from = mean_Enticement
      ) |>
      mutate(diff_enticement = `mean_Enticement_AIGenerated` - mean_Enticement_Photograph)
  )

ttest1 <- stats::t.test(diff_enticement ~ Feedback_AILessArousing, data = dfsub1_enticement)
```

```{r enticement 1 diff plot}
diff_plot1 <- dfsub1_enticement |> 
  ggplot(aes(x = Feedback_AILessArousing, y = diff_enticement, fill = Feedback_AILessArousing)) +
  geom_boxplot(width = 0.4,alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.1, size = 1) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 2, fill = "black") +
  labs(
    title = "Study 1",
    x = "Participant said AI is less arousing",
    y = "Enticement Difference (AI - Photo)"
  ) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.position = "none"
  )

diff_plot1
```

**Study 1**: `r report::report(ttest1, data = dfsub1_enticement)`

:::

#### Effect of Manipulation

```{r enticement 1 by condition belief plot }
df1 |> 
  ggplot(aes(x = Gender, y = Enticement, fill = ConditionBelief)) +
  geom_violin(position = position_dodge(width = 1), alpha = 0.7, trim = FALSE) +
  stat_pointinterval(position = position_dodge(width = 1),point_size = 1.5) +
  facet_grid(Relevance ~ Condition) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal(base_size = 14) +
  labs(subtitle ="Study 1", x = "Gender",y = "Enticement",fill = "Condition Belief")
```

```{r enticement 1 model load}
#| cache: false
 
m <- readRDS("models/ZOIB/ModelEnticement_1_ZOIB.rds")
```

<!-- Females reported lower enticement than males. Enticement was highest for relevant images with smaller relevance effects among females. Labeling images as AI-generated was associated with reduced enticement. -->

<!-- Participants who maintained label congruency across phases reported higher enticement than those who changed labels; this effect was larger for males. -->

```{r enticement 1 model analysis}
params_table(m)
summary(m, robust = TRUE)
# performance::performance(m)
```

##### Marginal contrasts

<!-- When participants maintained label congruency across phases, photographs were rated as more enticing than AI-generated images, particularly for relevant content, similar to arousal. This pattern reversed for when the labels were incongruent.  -->

```{r enticement est cont}
estimate_contrasts(m, contrast = "Condition", by=c("Gender", "Relevance", "ConditionBelief"), backend = "emmeans")
```

```{r enticement 1 model plot}

pred_e <- modelbased::estimate_means(m, by=c("Gender", "Relevance", "Condition", "ConditionBelief"), backend = "emmeans") |>
  as.data.frame()


pred_e |>
  mutate(Gender = fct_relevel(Gender, "Male", "Female")) |> 
  ggplot(aes(x=Relevance, y=Probability)) +
    geom_hline(yintercept=0, color="darkgrey") +
  geom_line(aes(group=Condition, color=Condition), position = position_dodge(width=0.2), alpha=0.8, linewidth=0.2) +
  geom_pointrange(aes(ymin = CI_low, ymax=CI_high, color=Condition), position = position_dodge(width=0.2), size=0.2) +
  # geom_text(data=stars1, aes(y=y, label=label), hjust=0.5, size=3) +
  # geom_rect(data=data.frame(Type="All trials", Proportion=0.1, Sex=as.factor("Male"), Outcome="Arousal", Relevance="Relevant"), 
            # aes(xmin=0.8, xmax=1.2, ymin=0.5, ymax=0.80), color="#8BC34A", alpha=0) +
  # geom_rect(data=data.frame(Type="All trials", Proportion=0.1, Sex=as.factor("Female"), Outcome="Arousal", Relevance="Relevant"), 
            # aes(xmin=0.8, xmax=1.2, ymin=0.2, ymax=0.5), color="#8BC34A", alpha=0) +
  facet_grid(Gender~ConditionBelief, switch = "y") +
  scale_y_continuous(limits=c(0, 1), labels=scales::percent) +
  scale_color_manual(values=c("AIGenerated"="#2196F3", "Photograph"="#F44336")) +
  theme_minimal() +
    theme(axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        axis.text.y = element_text(size = 8),
        strip.placement = "outside",
        strip.background.x = element_rect(fill=c("lightgrey"), color=NA),
        strip.text.x = element_text(size = 10),
        strip.text.y = element_text(size = 10),
        axis.text.x = element_text(angle=25, hjust=1, vjust=1.1, size=9, color="black"),
        legend.text = element_text(size = 10),
        legend.position = "bottom") +
  labs(color="Images presented as:",
       tag = "A")
```


#### Interindividual Variability
::: {.panel-tabset}

##### Random effects

<!-- Random effects indicate minimal reliable inter-individual in response to the label manipulation (i.e., individual differences in how AI interacts with relevance in terms of enticement ratings are not reliable)  -->

```{r enticement 1 d_vour}
m <- modelbased::estimate_grouplevel(m)
table_dvour(m)
```

##### Participant effects 

```{r enticement 1 ppt effects}
p_dvour(m, colors)
```

##### Sample analysis 

```{r enticement 1 sample analysis}

results_table(lm(`RelevanceRelevant:ConditionAIGenerated` ~ Intercept + Sample, data = df))
```

```{r enticement 1 country analysis}
results_table(lm(`RelevanceRelevant:ConditionAIGenerated` ~ Intercept + Country, data = df))
```

:::

#### Correlations (moderators)



```{r enticement  1 corr}

corr_mod(m, correlations)

```

### Valence

#### Manipulation Checks

::: {.panel-tabset}

##### Distributions

```{r dist valence 1}
#| fig-width: 12
valence_dist1 <- df1 |>
  ggplot(aes(x=Valence, fill = Condition)) +
  geom_histogram(position = "identity", alpha = 0.5, colour = "black", bins = 30) +
  scale_x_continuous(breaks = c(0, 1)) +
  labs(title = "Valence Study 1", ) +
  facet_wrap(~Gender) +
  scale_fill_manual(values=c("AIGenerated"="#2196F3", "Photograph"="#F44336")) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))


valence_dist1
```

##### Averages 

```{r valence 1 t_test}
#| message: false

dfsub1_valence <- dfsub1 |>
  right_join(
    df1 |>
      group_by(Participant, Condition) |>
      summarise(mean_Valence = mean(Valence, na.rm = TRUE), .groups = "drop") |>
      pivot_wider(
        names_from = Condition,
        names_prefix = "mean_Valence_",
        values_from = mean_Valence
      ) |>
      mutate(diff_valence = `mean_Valence_AIGenerated` - mean_Valence_Photograph)
  )

ttest1 <- stats::t.test(diff_valence ~ Feedback_AILessArousing, data = dfsub1_valence)
```

```{r valence 1 diff plot}
diff_plot1 <- dfsub1_valence |> 
  ggplot(aes(x = Feedback_AILessArousing, y = diff_valence, fill = Feedback_AILessArousing)) +
  geom_boxplot(width = 0.4,alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.1, size = 1) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 2, fill = "black") +
  labs(
    title = "Study 1",
    x = "Participant said AI is less arousing",
    y = "Valence Difference (AI - Photo)"
  ) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.position = "none"
  )

diff_plot1
```

**Study 1**: `r report::report(ttest1, data = dfsub1_valence)`
:::

#### Effect of Manipulation

```{r valence 1 by condition belief plot }
df1 |> 
  ggplot(aes(x = Gender, y = Valence, fill = ConditionBelief)) +
  geom_violin(position = position_dodge(width = 1), alpha = 0.7, trim = FALSE) +
  stat_pointinterval(position = position_dodge(width = 1),point_size = 1.5) +
  facet_grid(Relevance ~ Condition) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal(base_size = 14) +
  labs(subtitle ="Study 1", x = "Gender",y = "Valence",fill = "Condition Belief")
```

```{r valence 1 model}
m <- readRDS("models/ZOIB/ModelValence_1_ZOIB.rds")
```

Females reported lower enticement than males. Enticement was highest for relevant images with smaller relevance effects among females. Labeling images as AI-generated was associated with reduced enticement.

Participants who maintained label congruency across phases reported higher enticement than those who changed labels; this effect was larger for males.

```{r valence 1 model analysis}
params_table(m)
summary(m, robust = TRUE)
# performance::performance(m)
```

##### Marginal contrasts

```{r valence est cont}
estimate_contrasts(m, contrast = "Condition", by=c("Gender", "Relevance", "ConditionBelief"), backend = "emmeans")
```

```{r valence 1 model pred}

pred_v <- modelbased::estimate_means(m, by=c("Gender", "Relevance", "Condition", "ConditionBelief"), backend = "emmeans") |>
  as.data.frame()

pred_v |>
  mutate(Gender = fct_relevel(Gender, "Male", "Female")) |> 
  ggplot(aes(x=Relevance, y=Probability)) +
    geom_hline(yintercept=0, color="darkgrey") +
  geom_line(aes(group=Condition, color=Condition), position = position_dodge(width=0.2), alpha=0.8, linewidth=0.2) +
  geom_pointrange(aes(ymin = CI_low, ymax=CI_high, color=Condition), position = position_dodge(width=0.2), size=0.2) +
  # geom_text(data=stars1, aes(y=y, label=label), hjust=0.5, size=3) +
  # geom_rect(data=data.frame(Type="All trials", Proportion=0.1, Sex=as.factor("Male"), Outcome="Arousal", Relevance="Relevant"), 
            # aes(xmin=0.8, xmax=1.2, ymin=0.5, ymax=0.80), color="#8BC34A", alpha=0) +
  # geom_rect(data=data.frame(Type="All trials", Proportion=0.1, Sex=as.factor("Female"), Outcome="Arousal", Relevance="Relevant"), 
            # aes(xmin=0.8, xmax=1.2, ymin=0.2, ymax=0.5), color="#8BC34A", alpha=0) +
  facet_grid(Gender~ConditionBelief, switch = "y") +
  scale_y_continuous(limits=c(0, 1), labels=scales::percent) +
  scale_color_manual(values=c("AIGenerated"="#2196F3", "Photograph"="#F44336")) +
  theme_minimal() +
    theme(axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        axis.text.y = element_text(size = 8),
        strip.placement = "outside",
        strip.background.x = element_rect(fill=c("lightgrey"), color=NA),
        strip.text.x = element_text(size = 10),
        strip.text.y = element_text(size = 10),
        axis.text.x = element_text(angle=25, hjust=1, vjust=1.1, size=9, color="black"),
        legend.text = element_text(size = 10),
        legend.position = "bottom") +
  labs(color="Images presented as:",
       tag = "A")
```


#### Interindividual Variability
::: {.panel-tabset}

##### Random effects
```{r valence 1 d_vour}
m <- modelbased::estimate_grouplevel(m)
table_dvour(m)
```

##### Participant effects 

```{r valence 1 ppt effects}
p_dvour(m, colors)
```
##### Sample analysis 

```{r valence 1 sample df}

m_sample <- m |>
  select(Group, Level, Parameter, Median) |>
  filter(Group == "Participant" & Parameter %in% c("Intercept","RelevanceRelevant:ConditionAIGenerated")) |>
  pivot_wider(names_from = "Parameter", values_from = "Median") |>
  select(!Group) |>
  rename("Participant" = "Level") 
  

df <- dfsub1 |>
  left_join(m_sample, by = "Participant") |>
  rename("Gender" = "Sex")
```

```{r valence 1 sample analysis}

results_table(lm(`RelevanceRelevant:ConditionAIGenerated` ~ Intercept + Sample, data = df))
```

```{r valence 1 country analysis}
results_table(lm(`RelevanceRelevant:ConditionAIGenerated` ~ Intercept + Country, data = df))
```

:::

#### Correlations (moderators)


```{r valence 1 corr}
corr_mod(m, correlations)
```
:::

# Study 2

## Rate Belief

```{r ratebelief 2}

rate2 <- table(df2$Feedback_AllReal)["True"] / sum(table(df2$Feedback_AllReal))
```

In study 2 (i.e., gave feedback that all images were real images) was `r round(mean(rate2) * 100, 1)`%. 


## Models
::: {.panel-tabset}

### Arousal

#### Manipulation Checks
::: {.panel-tabset}

##### Distributions

```{r dist arousal 2}
#| fig-width: 12
arousal_dist2 <- df2 |>
  ggplot(aes(x=Arousal, fill = Condition)) +
  geom_bar(position = "identity", alpha = 0.5, colour = "black") +
  scale_y_sqrt(expand = c(0, 0)) +
  scale_x_continuous(breaks = c(0, 1)) +
  labs(title = "Arousal Study 2", ) +
  facet_wrap(~Gender) +
  scale_fill_manual(values=c("AIGenerated"="#2196F3", "Photograph"="#F44336")) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))

arousal_dist2
```

##### Averages 

```{r arousal 2 t_test}
#| message: false

dfsub2_arousal <- dfsub2 |>
  right_join(
    df2|>
      group_by(Participant, Condition)|>
      summarise(mean_arousal = mean(Arousal, na.rm = TRUE), .groups = "drop") |>
      pivot_wider(names_from = Condition, 
                  names_prefix = "mean_Arousal_", 
                  values_from = mean_arousal) |>
      mutate(diff_arousal = `mean_Arousal_AIGenerated` - mean_Arousal_Photograph)
  )

ttest2 <- stats::t.test(diff_arousal ~ Feedback_AILessArousing, data = dfsub2_arousal)
```

```{r arousal 2 diff plot}
diff_plot2 <- dfsub2_arousal |> 
  ggplot(aes(x = Feedback_AILessArousing, y = diff_arousal, fill = Feedback_AILessArousing)) +
  geom_boxplot(width = 0.4, alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.1, size = 1) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 2, fill = "black") +
  labs(
    title = "Study 2",
    x = "Participant said AI is less arousing",
    y = "Arousal Difference (AI - Photo)"
  ) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.position = "none"
  )

diff_plot2
```

**Study 2**: `r report::report(ttest2, data = dfsub2_arousal)`
:::

#### Effect of Manipulation

```{r arousal 2 by condition belief plot }
df2 |> 
  ggplot(aes(x = Gender, y = Arousal, fill = ConditionBelief)) +
  geom_violin(position = position_dodge(width = 1), alpha = 0.7, trim = FALSE) +
  stat_pointinterval(position = position_dodge(width = 1),point_size = 1.5) +
  facet_grid( ~ Condition) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal(base_size = 14) +
  labs(title = "Arousal by Gender × Belief × Condition", subtitle ="Study 2", x = "Gender", y = "Arousal",fill = "Condition Belief")

```

```{r arousal 2 model load}
#| cache: false
 
m <- readRDS("models/ZOIB/ModelArousal_2_ZOIB.rds")
```

```{r arousal 2 model analysis}
params_table(m)
summary(m, robust = TRUE)
# performance::performance(m)
```

```{r arousal 2 est cont}
estimate_contrasts(m, contrast = "Condition", by=c("Gender", "ConditionBelief"), backend = "emmeans")
```

##### Marginal contrasts

```{r arousal 2 model plot}

pred_a2 <- modelbased::estimate_means(m, by=c("Gender", "Condition", "ConditionBelief"), backend = "emmeans") |>
  as.data.frame()

pred_a2 |>
  mutate(Gender = fct_relevel(Gender, "Male", "Female")) |> 
  ggplot(aes(x=ConditionBelief, y=Probability)) +
    geom_hline(yintercept=0, color="darkgrey") +
  geom_line(aes(group=Condition, color=Condition), position = position_dodge(width=0.2), alpha=0.8, linewidth=0.2) +
  geom_pointrange(aes(ymin = CI_low, ymax=CI_high, color=Condition), position = position_dodge(width=0.2), size=0.2) +
  # geom_text(data=stars1, aes(y=y, label=label), hjust=0.5, size=3) +
  # geom_rect(data=data.frame(Type="All trials", Proportion=0.1, Sex=as.factor("Male"), Outcome="Arousal", Relevance="Relevant"), 
            # aes(xmin=0.8, xmax=1.2, ymin=0.5, ymax=0.80), color="#8BC34A", alpha=0) +
  # geom_rect(data=data.frame(Type="All trials", Proportion=0.1, Sex=as.factor("Female"), Outcome="Arousal", Relevance="Relevant"), 
            # aes(xmin=0.8, xmax=1.2, ymin=0.2, ymax=0.5), color="#8BC34A", alpha=0) +
  facet_grid(~Gender, switch = "y") +
  scale_y_continuous(limits=c(0, 1), labels=scales::percent) +
  scale_color_manual(values=c("AIGenerated"="#2196F3", "Photograph"="#F44336")) +
  theme_minimal() +
    theme(axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        axis.text.y = element_text(size = 8),
        strip.placement = "outside",
        strip.background.x = element_rect(fill=c("lightgrey"), color=NA),
        strip.text.x = element_text(size = 10),
        strip.text.y = element_text(size = 10),
        axis.text.x = element_text(angle=25, hjust=1, vjust=1.1, size=9, color="black"),
        legend.text = element_text(size = 10),
        legend.position = "bottom") +
  labs(color="Images presented as:",
       tag = "A")
```

#### Interindividual Variability

::: {.panel-tabset}

##### Random effects
```{r arousal 2 d_vour}
m <- modelbased::estimate_grouplevel(m)
table_dvour(m)
```

##### Participant effects 

```{r arousal 2 ppt effects}
colors2 <- c("Intercept" = "#9C27B0", "AI-Generated" = "#FF9800")


## plot for participant effects
p_dvour <- function(m, colors){
  m |>
    mutate(
      Group = fct_relevel(Group, "Participant", "Item"),
      Parameter = fct_relevel(Parameter, "Intercept", "ConditionAIGenerated"),
    Parameter = fct_recode(
      Parameter,
      `AI-Generated` = "ConditionAIGenerated"))|>
    ggplot(aes(x = Median , y = Level)) +
    geom_pointrange(
      aes(xmin = CI_low, xmax = CI_high, color = Parameter),
      linewidth = 0.3, size = 0.05
    ) +
    facet_grid(Group ~ Parameter, scales = "free", switch = "both") +
    ggside::ggside(scales = "free") +
    ggside::geom_xsidedensity(aes(fill = Parameter), color = NA) +
    # scale_x_continuous(limits = c(-2,2), breaks = seq(-2, 2, 1)) +
    scale_color_manual(values = colors) +
    scale_fill_manual(values = colors) +
    theme_minimal() +
    theme(
      axis.text.y = element_blank(),
      axis.ticks.y = element_blank(),
      strip.placement.x = "outside",
      strip.background = element_rect(fill = NA, color = NA),
      axis.title = element_blank(),
      panel.grid.minor = element_blank(),
      panel.grid.major.y = element_blank(),
      axis.text.x = element_text(hjust = 1, size =12 ),
      legend.position = "none")
}
```

```{r}
p_dvour(m, colors2)
```
##### Sample analysis 

```{r arousal 2 sample df}

m_sample <- m |>
  select(Group, Level, Parameter, Median) |>
  filter(Group == "Participant" & Parameter %in% c("Intercept","ConditionAIGenerated")) |>
  pivot_wider(names_from = "Parameter", values_from = "Median") |>
  select(!Group) |>
  rename("Participant" = "Level") 
  

df <- dfsub1 |>
  left_join(m_sample, by = "Participant") |>
  rename("Gender" = "Sex")
```

```{r arousal 2 sample analysis}

results_table(lm(ConditionAIGenerated ~ Intercept + Sample, data = df))
```

```{r arousal 2 country analysis}
results_table(lm(ConditionAIGenerated ~ Intercept + Country, data = df))
```

:::

#### Correlations (moderators)

```{r df 2 corr}
correlations2 <- df2 |>
  select(Participant, "BAIT_Attitudes", "BAIT_Expectations", "BAIT_Expertise", "BAIT_Discrimination", "BAIT_Bias", "BAIT_Total", "PornFrequency", "SexualActivity_num", "COPS_Frequency", "AllRealConfidence", "AllFakeConfidence", "Enjoyment", -"Bait_Duration") |>
  rename(SexualActivity = SexualActivity_num,
         SexualActivity_num)

corr_mod <- function(m, correlations){
  features1 <- reshape_grouplevel(m, indices = "Median", group = "Participant") |> 
  full_join(correlations, by = "Participant")  |>
  rename(`AI-Generated` = ConditionAIGenerated)
  

  cordata <- correlation::correlation(select(features1, -Participant), p_adjust = "none", redundant = TRUE) |> 
    correlation::cor_sort() |>
    correlation::cor_lower() |>
    as.data.frame() |>
      mutate(Parameter2 = fct_rev(Parameter2),
         Parameter1 = fct_relabel(Parameter1, \(x) gsub("_Intercept", "", x)),
         Parameter2 = fct_relabel(Parameter2, \(x) gsub("_Intercept", "", x)),
         Parameter1 = fct_relabel(Parameter1, \(x) gsub("_", " - ", x)),
         Parameter2 = fct_relabel(Parameter2, \(x) gsub("_", " - ", x)))
  
  p2_cor <- cordata |> 
    ggplot(aes(x=Parameter2, y = Parameter1)) +
    geom_tile(aes(fill = r)) +
    geom_text(aes(label = insight::format_value(r, 2, zap_small = TRUE, lead_zero = FALSE)), color = ifelse(cordata$p < 0.01, "black", "grey")) +
    scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
    theme_minimal() +
    theme(
      axis.text.x = element_text(angle = 45, hjust = 1),
      axis.title.x = element_blank(),
      axis.title.y = element_blank(),
      legend.position = "none"
    )
  p2_cor
  
}

```


```{r arousal 2 corr}

corr_mod(m, correlations2)
``` 

### Enticement

#### Manipulation Checks

::: {.panel-tabset}

##### Distributions 

```{r dist enticement 2}
#| fig-width: 12
enticement_dist2 <- df2 |>
  ggplot(aes(x=Enticement, fill = Condition)) +
  geom_bar(position = "identity", alpha = 0.5, colour = "black") +
  scale_y_sqrt(expand = c(0, 0)) +
  scale_x_continuous(breaks = c(0, 1)) +
  labs(title = "Enticement Study 2", ) +
  facet_wrap(~Gender) +
  scale_fill_manual(values=c("Photograph"="#F44336", "AIGenerated"="#2196F3")) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))

enticement_dist2
```

##### Averages 

```{r enticement 2 t_test}
#| message: false

dfsub2_enticement <- dfsub2 |>
  right_join(
    df2|>
      group_by(Participant, Condition)|>
      summarise(mean_Enticement = mean(Enticement, na.rm = TRUE), .groups = "drop") |>
      pivot_wider(names_from = Condition, 
                  names_prefix = "mean_Enticement_", 
                  values_from = mean_Enticement) |>
      mutate(diff_enticement = `mean_Enticement_AIGenerated` - mean_Enticement_Photograph)
  )

ttest2 <- stats::t.test(diff_enticement ~ Feedback_AILessArousing, data = dfsub2_enticement)
```

```{r enticement 2 diff plot}
diff_plot2 <- dfsub2_enticement |> 
  ggplot(aes(x = Feedback_AILessArousing, y = diff_enticement, fill = Feedback_AILessArousing)) +
  geom_boxplot(width = 0.4, alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.1, size = 1) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 2, fill = "black") +
  labs(
    title = "Study 2",
    x = "Participant said AI is less arousing",
    y = "Enticement Difference (AI - Photo)"
  ) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.position = "none"
  )

diff_plot2
```

**Study 2**: `r report::report(ttest2, data = dfsub2_enticement)`

:::

#### Effect of Manipulation

```{r enticement 2 by condition belief plot }
df2 |> 
  ggplot(aes(x = Gender, y = Enticement, fill = ConditionBelief)) +
  geom_violin(position = position_dodge(width = 1), alpha = 0.7, trim = FALSE) +
  stat_pointinterval(position = position_dodge(width = 1),point_size = 1.5) +
  facet_grid( ~ Condition) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal(base_size = 14) +
  labs(title = "Enticement by Gender × Belief × Condition", subtitle ="Study 2", x = "Gender", y = "Arousal",fill = "Condition Belief")

```

```{r enticement 2 model load}
#| cache: false
 
m <- readRDS("models/ZOIB/ModelEnticement_2_ZOIB.rds")
```

```{r enticement 2 model analysis}
params_table(m)
summary(m, robust = TRUE)
# performance::performance(m)
```

##### Marginal contrasts

```{r enticement 2 est cont}
estimate_contrasts(m, contrast = "Condition", by=c("Gender", "ConditionBelief"), backend = "emmeans")
```

```{r enticement 2 model plot}

pred_e2 <- modelbased::estimate_means(m, by=c("Gender", "Condition", "ConditionBelief"), backend = "emmeans") |>
  as.data.frame()

pred_e2 |>
  mutate(Gender = fct_relevel(Gender, "Male", "Female")) |> 
  ggplot(aes(x=ConditionBelief, y=Probability)) +
    geom_hline(yintercept=0, color="darkgrey") +
  geom_line(aes(group=Condition, color=Condition), position = position_dodge(width=0.2), alpha=0.8, linewidth=0.2) +
  geom_pointrange(aes(ymin = CI_low, ymax=CI_high, color=Condition), position = position_dodge(width=0.2), size=0.2) +
  # geom_text(data=stars1, aes(y=y, label=label), hjust=0.5, size=3) +
  # geom_rect(data=data.frame(Type="All trials", Proportion=0.1, Sex=as.factor("Male"), Outcome="Arousal", Relevance="Relevant"), 
            # aes(xmin=0.8, xmax=1.2, ymin=0.5, ymax=0.80), color="#8BC34A", alpha=0) +
  # geom_rect(data=data.frame(Type="All trials", Proportion=0.1, Sex=as.factor("Female"), Outcome="Arousal", Relevance="Relevant"), 
            # aes(xmin=0.8, xmax=1.2, ymin=0.2, ymax=0.5), color="#8BC34A", alpha=0) +
  facet_grid(~Gender, switch = "y") +
  scale_y_continuous(limits=c(0, 1), labels=scales::percent) +
  scale_color_manual(values=c("AIGenerated"="#2196F3", "Photograph"="#F44336")) +
  theme_minimal() +
    theme(axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        axis.text.y = element_text(size = 8),
        strip.placement = "outside",
        strip.background.x = element_rect(fill=c("lightgrey"), color=NA),
        strip.text.x = element_text(size = 10),
        strip.text.y = element_text(size = 10),
        axis.text.x = element_text(angle=25, hjust=1, vjust=1.1, size=9, color="black"),
        legend.text = element_text(size = 10),
        legend.position = "bottom") +
  labs(color="Images presented as:",
       tag = "A")
```

#### Interindividual Variability
::: {.panel-tabset}

##### Random effects
```{r enticement 2  d_vour}
m <- modelbased::estimate_grouplevel(m)
table_dvour(m)
```

##### Participant effects 

```{r enticement 2 ppt effects}
p_dvour(m, colors2)
```

##### Sample analysis 

```{r enticement 2 sample df}

m_sample <- m |>
  select(Group, Level, Parameter, Median) |>
  filter(Group == "Participant" & Parameter %in% c("Intercept","ConditionAIGenerated")) |>
  pivot_wider(names_from = "Parameter", values_from = "Median") |>
  select(!Group) |>
  rename("Participant" = "Level") 
  

df <- dfsub1 |>
  left_join(m_sample, by = "Participant") |>
  rename("Gender" = "Sex")
```

```{r enticement 2  sample analysis}

results_table(lm(ConditionAIGenerated ~ Intercept + Sample, data = df))
```

```{r enticement 2 country analysis}
results_table(lm(ConditionAIGenerated ~ Intercept + Country, data = df))
```

:::

#### Correlations (moderators)

- enticement lower nait toal correlations from 0.25 to .14 same with expertise

```{r enticement 2 corr}
corr_mod(m, correlations2)
```  

### Valence

#### Manipulation Checks

::: {.panel-tabset}

##### Distributions

```{r dist valence 2}
#| fig-width: 12
valence_dist2 <- df2 |>
  ggplot(aes(x=Valence, fill = Condition)) +
  geom_bar(position = "identity", alpha = 0.5, colour = "black") +
  scale_y_sqrt(expand = c(0, 0)) +
  scale_x_continuous(breaks = c(0, 1)) +
  labs(title = "Valence Study 2", ) +
  facet_wrap(~Gender) +
  scale_fill_manual(values=c("Photograph"="#F44336", "AIGenerated"="#2196F3")) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))

valence_dist2
```

##### Averages 

```{r valence 2 t_test}
#| message: false

dfsub2_valence <- dfsub2 |>
  right_join(
    df2|>
      group_by(Participant, Condition)|>
      summarise(mean_Valence = mean(Valence, na.rm = TRUE), .groups = "drop") |>
      pivot_wider(names_from = Condition, 
                  names_prefix = "mean_Valence_", 
                  values_from = mean_Valence) |>
      mutate(diff_valence = `mean_Valence_AIGenerated` - mean_Valence_Photograph)
  )

ttest2 <- stats::t.test(diff_valence ~ Feedback_AILessArousing, data = dfsub2_valence)
```

```{r valence 2 diff plot}
diff_plot2 <- dfsub2_valence |> 
  ggplot(aes(x = Feedback_AILessArousing, y = diff_valence, fill = Feedback_AILessArousing)) +
  geom_boxplot(width = 0.4, alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.1, size = 1) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 2, fill = "black") +
  labs(
    title = "Study 2",
    x = "Participant said AI is less arousing",
    y = "Valence Difference (AI - Photo)"
  ) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.position = "none"
  )

diff_plot2
```

**Study 2**: `r report::report(ttest2, data = dfsub2_valence)`

:::

#### Effect of Manipulation

```{r valence 2 by condition belief plot }
df2 |> 
  ggplot(aes(x = Gender, y = Valence, fill = ConditionBelief)) +
  geom_violin(position = position_dodge(width = 1), alpha = 0.7, trim = FALSE) +
  stat_pointinterval(position = position_dodge(width = 1),point_size = 1.5) +
  facet_grid( ~ Condition) +
  scale_fill_manual(values = c("True" = "#E66100", "False" = "#5D3A9B")) +
  theme_minimal(base_size = 14) +
  labs(title = "Valence by Gender × Belief × Condition", subtitle ="Study 2", x = "Gender", y = "Arousal",fill = "Condition Belief")
```

```{r valence 2 model load}
#| cache: false
 
m <- readRDS("models/ZOIB/ModelValence_2_ZOIB.rds")
```

```{r valence 2 model analysis}
params_table(m)
summary(m, robust = TRUE)
# performance::performance(m)
```

##### Marginal contrasts

```{r valence 2 est cont}
estimate_contrasts(m, contrast = "Condition", by=c("Gender", "ConditionBelief"), backend = "emmeans")
```

```{r valence 2 model plot}

pred_v2 <- modelbased::estimate_means(m, by=c("Gender", "Condition", "ConditionBelief"), backend = "emmeans") |>
  as.data.frame()

pred_v2 |>
  mutate(Gender = fct_relevel(Gender, "Male", "Female")) |> 
  ggplot(aes(x=ConditionBelief, y=Probability)) +
    geom_hline(yintercept=0, color="darkgrey") +
  geom_line(aes(group=Condition, color=Condition), position = position_dodge(width=0.2), alpha=0.8, linewidth=0.2) +
  geom_pointrange(aes(ymin = CI_low, ymax=CI_high, color=Condition), position = position_dodge(width=0.2), size=0.2) +
  # geom_text(data=stars1, aes(y=y, label=label), hjust=0.5, size=3) +
  # geom_rect(data=data.frame(Type="All trials", Proportion=0.1, Sex=as.factor("Male"), Outcome="Arousal", Relevance="Relevant"), 
            # aes(xmin=0.8, xmax=1.2, ymin=0.5, ymax=0.80), color="#8BC34A", alpha=0) +
  # geom_rect(data=data.frame(Type="All trials", Proportion=0.1, Sex=as.factor("Female"), Outcome="Arousal", Relevance="Relevant"), 
            # aes(xmin=0.8, xmax=1.2, ymin=0.2, ymax=0.5), color="#8BC34A", alpha=0) +
  facet_grid(~Gender, switch = "y") +
  scale_y_continuous(limits=c(0, 1), labels=scales::percent) +
  scale_color_manual(values=c("AIGenerated"="#2196F3", "Photograph"="#F44336")) +
  theme_minimal() +
    theme(axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        axis.text.y = element_text(size = 8),
        strip.placement = "outside",
        strip.background.x = element_rect(fill=c("lightgrey"), color=NA),
        strip.text.x = element_text(size = 10),
        strip.text.y = element_text(size = 10),
        axis.text.x = element_text(angle=25, hjust=1, vjust=1.1, size=9, color="black"),
        legend.text = element_text(size = 10),
        legend.position = "bottom") +
  labs(color="Images presented as:",
       tag = "A")
```


#### Interindividual Variability

::: {.panel-tabset}

##### Random effects
```{r valence 2 d_vour}
m <- modelbased::estimate_grouplevel(m)
table_dvour(m)
```

##### Participant effects 

```{r valence 2 ppt effects}
p_dvour(m, colors2)
```

##### Sample analysis 

```{r valence 2 sample df}

m_sample <- m |>
  select(Group, Level, Parameter, Median) |>
  filter(Group == "Participant" & Parameter %in% c("Intercept","ConditionAIGenerated")) |>
  pivot_wider(names_from = "Parameter", values_from = "Median") |>
  select(!Group) |>
  rename("Participant" = "Level") 
  

df <- dfsub1 |>
  left_join(m_sample, by = "Participant") |>
  rename("Gender" = "Sex")
```

```{r valence 2 sample analysis}

results_table(lm(ConditionAIGenerated ~ Intercept + Sample, data = df))
```

```{r valence 2 country analysis}
results_table(lm(ConditionAIGenerated ~ Intercept + Country, data = df))
```

:::

#### Correlations (moderators)

```{r valence 2 corr}
corr_mod(m, correlations2)
``` 
:::

# Figures 

```{r}
df_long <- df1 |>
  select(Gender, Condition, Arousal, Enticement, Valence) |>
  pivot_longer(cols = c(Arousal, Enticement, Valence),
               names_to = "Outcome",
               values_to = "Score") |>
  mutate(Outcome = factor(Outcome, levels = c("Arousal", "Enticement", "Valence")),
         Gender = fct_relevel(Gender, "Male", "Female"),
         Condition = fct_relevel(Condition, "Photograph", "AIGenerated"),
         Condition = fct_recode(Condition, "Photograph"="Photograph", "AI-Generated" = "AIGenerated")) 

# Plot
dist_plot <- df_long |>
  ggplot(aes(x = Score, fill = Condition)) +
  geom_histogram(position = "identity", alpha = 0.5, colour = "black", bins = 30) +
  facet_grid(Outcome ~ Gender, switch = "y", scales = "free") +
  scale_fill_manual(values = c("AI-Generated" = "#2196F3", "Photograph" = "#F44336")) +
  labs(fill = "Condition:") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        axis.text.y = element_text(size = 8),
        strip.placement = "outside",
        strip.background.x = element_rect(fill=c("lightgrey"), color=NA),
        strip.text = element_text(face = "bold", size = 10),
        strip.text.y = element_text(size = 10),
        axis.text.x = element_text(hjust=1, vjust=1.1, size=9, color="black"),
        legend.text = element_text(size = 10),
        legend.title = element_text(size = 10, face = "bold"), 
        legend.position = "bottom")

```

```{r}

df_long2 <- df2 |>
  select(Gender, Condition, Arousal, Enticement, Valence) |>
  pivot_longer(cols = c(Arousal, Enticement, Valence),
               names_to = "Outcome",
               values_to = "Score") |>
  mutate(Outcome = factor(Outcome, levels = c("Arousal", "Enticement", "Valence")),
         Gender = fct_relevel(Gender, "Male", "Female"),
         Condition = fct_relevel(Condition, "Photograph", "AIGenerated"),
         Condition = fct_recode(Condition, "Photograph"="Photograph", "AI-Generated" = "AIGenerated")) 

# Plot
dist_plot <- df_long2 |>
  ggplot(aes(x = Score, fill = Condition)) +
  geom_bar(position = "identity", alpha = 0.5, colour = "black") +
  facet_grid(Outcome ~ Gender, switch = "y", scales = "free") +
  scale_fill_manual(values = c("AI-Generated" = "#2196F3", "Photograph" = "#F44336")) +
  labs(fill = "Condition:") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        axis.text.y = element_text(size = 8),
        strip.placement = "outside",
        strip.background.x = element_rect(fill=c("lightgrey"), color=NA),
        strip.text = element_text(face = "bold", size = 10),
        strip.text.y = element_text(size = 10),
        axis.text.x = element_text(hjust=1, vjust=1.1, size=9, color="black"),
        legend.text = element_text(size = 10),
        legend.title = element_text(size = 10, face = "bold"), 
        legend.position = "bottom")

dist_plot
```
