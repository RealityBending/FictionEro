---
title: "FictionEro2 - Affective Impact of Fiction"
editor: source
editor_options: 
  chunk_output_type: console
format:
  html:
    code-fold: true
    self-contained: false
    toc: true
---

## Data Preparation

```{r}
#| message: false
#| warning: false

library(tidyverse)
library(easystats)
library(patchwork)
library(ggside)
library(glmmTMB)

options(mc.cores = parallel::detectCores(),
        brms.backend = "cmdstanr",
        width = 300)
```

```{r data preparation}
#| warning: false
#| 
dfsub <- read.csv("../data/data_participants.csv")

df <- read.csv("../data/data.csv") |> 
  right_join(
    select(dfsub, Participant, Mobile, starts_with(c("Feedback_","BAIT")), COPS_Frequency, SexualActivity,- Feedback_Text),
    by = "Participant"
    ) |> 
    datawizard::rescale(select= c("Arousal", "Enticing", "Valence"), range=c(0, 6), to=c(0,1)) |> 
  datawizard::rescale(select= c("Realness"), range=c(-3,3), to=c(0,1)) |>
  mutate(Condition = case_when(
    Condition == "Fiction" ~ "AI-Generated",
    Condition == "Reality" ~ "Photograph"
  )) |>
  mutate(Condition = fct_relevel(Condition, "Photograph", "AI-Generated"),
         Gender =  fct_relevel(Gender, "Male", "Female"),
         PornFrequency = as.numeric(as.factor(COPS_Frequency)),
         SexualActivity_num = as.numeric(as.factor(SexualActivity)),
         ConditionBelief = case_when(
           Condition == "Photograph" & Realness > 0.5 ~ "True",
           Condition == "AI-Generated" & Realness < 0.5 ~ "True",
           .default = "False",
         )) |>
  rename(AllRealConfidence = "Feedback_AllRealConfidence",
         AllFakeConfidence = "Feedback_AllFakeConfidence",
         Enjoyment = "Feedback_Enjoyment"
         )|>
  mutate(across(starts_with("Feedback_"), as.factor)) |>
  mutate(ConditionBelief = as.factor(ConditionBelief))

results_table <- function(model, effects="fixed", filter=NULL) {
  if("marginaleffects" %in% class(model)) {
    model |> 
      parameters::parameters() |> 
      as.data.frame() |> 
      select(-Parameter, -SE, -S, z=Statistic, -Predicted) |> 
      insight::format_table() |> 
      parameters::display()
  } else {
    display(parameters::parameters(model, effects=effects, keep=filter))
  }
}

```

**Note**: [These calculations are based on the validation of the BAIT scale](https://realitybending.github.io/FictionEro/study1/analysis/1_cleaning.html)

```{r Bait Dimensions}

df$BAIT_Videos <- (df$BAIT_VideosRealistic + (1 - df$BAIT_VideosIssues)) / 2

df$BAIT_Visual = (df$BAIT_ImagesRealistic + (1 - df$BAIT_ImagesIssues) + df$BAIT_ImitatingReality + df$BAIT_EnvironmentReal) / 4

df$BAIT_Text = (df$BAIT_TextRealistic + (1 - df$BAIT_TextIssues)) / 2

df$BAIT_Negative <- (df$BAIT_Worry + df$BAIT_Dangerous)/2

df$BAIT_Positive <- (df$BAIT_Exciting + df$BAIT_Benefit)/2
```


## Visualisation of Key Variables

This section is about selecting the best model. Notably, **all the stimuli presented are of an erotic nature**.
Note that variables were rescaled to [0,1] when fitting the models and that the stimuli presented to participants was assigned according to their self-rated sexuality, making **all stimuli relevant** to participants. 

To summarise, **women** rate stimuli on average **significantly lower** in arousal, enticiment and valence than **men**. 

::: panel-tabset

### Arousal

In general, males exhibited greater variability in their arousal ratings, while females tended to provide more lower arousal ratings.

The pattern of arousal ratings for images that participants believed to be either AI-generated or photos (i.e., initially labeled as photos and later rated as photos, or initially labeled as AI and later rated as AI), as well as for images where participants disagreed with the original labels, was generally similar within genders. However, between genders, women tended to provide more low arousal ratings than men.

```{r Arousal1}
arousal <- df |> 
  ggplot(aes(x=Arousal, fill = Gender)) +
  geom_bar() +
  scale_y_sqrt(expand = c(0, 0)) +
  scale_x_continuous(
    breaks = c(0, 1),
    labels = c("Not at all","Very much")) +
  labs(title = "Arousal", ) +
  facet_wrap(~Gender) +
   scale_fill_manual(values=c("Male"="#E91E63", "Female"="#FF9800"), guide="none") +
  theme_abyss() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))

arousal
```

```{r Arousal2}

df |> 
  mutate(ConditionBelief = as.factor(ConditionBelief)) |> 
  mutate(ConditionBelief = case_when(
    ConditionBelief == "False" ~ "Not Believed",
    ConditionBelief == "True" ~ "Believed",)) |>
  ggplot(aes(x=Arousal, fill=Gender)) +
  geom_bar(position = "identity") +
   scale_x_continuous(
    breaks = c(0, 1),
    labels = c("Not at all","Very much")) +
  facet_grid(Gender~ConditionBelief, scales="free_y") +
  scale_color_manual(values=c("red", "white"), guide="none") +
  scale_fill_manual(values=c("Male"="#E91E63", "Female"="#FF9800"), guide="none") +
  # scale_y_sqrt(expand = c(0, 0)) +
  labs(title = "Arousal Ratings for Images Based on Belief in Original Labels") +
  theme_abyss() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))
```

```{r Arousal Model selection}
#| eval: false

# Get a sense of Random Factors
m1 <- glmmTMB::glmmTMB(Arousal ~ Gender + (1|Participant), data=df)
m2 <- glmmTMB::glmmTMB(Arousal ~ Gender + (1|Participant) + (1|Stimulus ), data=df)
m3 <- glmmTMB::glmmTMB(Arousal ~ Gender + (1|Participant) + (1+Gender|Stimulus ), data=df)


test_bf(m1,m2, m3)
compare_performance(m1, m2, m3)

# Model m3, which includes random intercepts for Participants and both random intercepts and slopes for Gender at the Stimulus level, seems to be the best
```

This model evaluate ths the effects of Gender on Arousal, accounting for random variability due to participants (i.e., random effects). The analysis revealed that on average **women rate erotic stimuli significantly lower in arousal than men**. 

```{r Arousal3}

m_a <- glmmTMB::glmmTMB(Arousal ~ Gender + (1|Participant),
                      data=df, family=glmmTMB::ordbeta(),
                      control = glmmTMB::glmmTMBControl(parallel = 8))
                      # control = glmmTMB::glmmTMBControl(optimizer=stats::optim, # nlminb, optim
                      #                                   optArgs = list(method = "BFGS"),  #Nelder-Mead, BFGS, CG
                      #                                   parallel = 8))

results_table(m_a)

```

```{r Arousal Plot}
estimate_relation(m_a) |> 
  ggplot(aes(x=Gender, y=Predicted)) +
  geom_pointrange(aes(ymin=CI_low, ymax=CI_high, color = Gender), position=position_dodge(width=0.5)) +
 scale_color_manual(values=c("Male"="#E91E63", "Female"="#FF9800"), guide="none") +  labs(y="Arousal") +
  theme_abyss()
```

### Enticement

In general, males tended to rate images higher in enticement more often than females. 

Enticing ratings for images where participants believed in the original labels, as well as for those where they disagreed with the labels, were similar for within genders, with males providing higher ratings of enticement. 

For females, although a similar pattern was observed, they tended to provide more lower enticement ratings, particularly for images where they disagreed with the original labels.


```{r Enticement1}
enticiment <- df |> 
  ggplot(aes(x=Enticing, fill = Gender)) +
  geom_bar() +
  scale_y_sqrt(expand = c(0, 0)) +
  scale_x_continuous(
    breaks = c(0, 1),
    labels = c("Not at all","Very much")) +
  labs(title = "Enticement", ) +
  facet_wrap(~Gender) +
   scale_fill_manual(values=c("Male"="#E91E63", "Female"="#FF9800"), guide="none") +
  theme_abyss() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))

enticiment
```

```{r Enticement2}

df |> 
  mutate(ConditionBelief = as.factor(ConditionBelief)) |> 
  mutate(ConditionBelief = case_when(
    ConditionBelief == "False" ~ "Not Believed",
    ConditionBelief == "True" ~ "Believed",)) |>
  ggplot(aes(x=Enticing, fill=Gender)) +
  geom_bar(position = "identity", binwidth = 0.5) +
  scale_x_continuous(
    breaks = c(0, 1),
    labels = c("Not at all","Very much")) +
  facet_grid(Gender~ConditionBelief, scales="free_y") +
  scale_fill_manual(values=c("Female"="#E91E63", "Male"="#FF9800"), guide="none") +
  # scale_y_sqrt(expand = c(0, 0)) +
  labs(title = "Enticement Ratings for Images Based on Belief in Original Labels") +
  theme_abyss() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))
```

This model evaluate ths the effects of Gender on Enticement, accounting for random variability due to participants (i.e., random effects). The analysis revealed that on average **women rate erotic stimuli significantly lower in enticiment than men**. 

```{r Enticicement3}
m_e <- glmmTMB::glmmTMB(Enticing ~ Gender + (1|Participant),
                      data=df,family=glmmTMB::ordbeta(),
                      control = glmmTMB::glmmTMBControl(parallel = 8))
                      # control = glmmTMB::glmmTMBControl(optimizer=stats::optim, # nlminb, optim
                      #                                   optArgs = list(method = "BFGS"),  #Nelder-Mead, BFGS, CG
                      #                                   parallel = 8))

results_table(m_e)

```

```{r Enticement plot}
estimate_relation(m_e) |> 
  ggplot(aes(x=Gender, y=Predicted)) +
  geom_pointrange(aes(ymin=CI_low, ymax=CI_high, color = Gender), position=position_dodge(width=0.5)) +
 scale_color_manual(values=c("Male"="#E91E63", "Female"="#FF9800"), guide="none") +  labs(y="Enticement") +
  theme_abyss()
```

### Valence

In general, males tended to assign higher valence ratings to images more frequently. Females, on the other hand, showed higher frequencies of ratings in the middle and lower ranges of the valence scale.

The pattern of valence ratings for images, whether believed or not believed, was similar within genders, with ratings for believed images closely resembling those for non-believed images.

```{r Valence1}
valence <- df |> 
  ggplot(aes(x=Valence, fill = Gender)) +
  geom_bar() +
  scale_y_sqrt(expand = c(0, 0)) +
  scale_x_continuous(
    breaks = c(0, 1),
    labels = c("Unplesant","Pleasant")) +
  scale_fill_manual(values=c("Male"="#E91E63", "Female"="#FF9800"), guide="none") +
  labs(title = "Valence", ) +
    facet_wrap(~Gender) +
  theme_abyss() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))

valence
```

```{r Valence2}

df |> 
  mutate(ConditionBelief = as.factor(ConditionBelief)) |> 
  mutate(ConditionBelief = case_when(
    ConditionBelief == "False" ~ "Not Believed",
    ConditionBelief == "True" ~ "Believed",)) |>
  ggplot(aes(x=Valence, fill=Gender)) +
  geom_bar(position = "identity", binwidth = 0.5) +
  scale_x_continuous(
    breaks = c(0, 1),
    labels = c("Unplesant","Pleasant")) +
  facet_grid(Gender~ConditionBelief, scales="free_y") +
  scale_fill_manual(values=c("Female"="#E91E63", "Male"="#FF9800"), guide="none") +
  # scale_y_sqrt(expand = c(0, 0)) +
  labs(title = "Valence to Ratings for Images Based on Belief in Original Labels") +
  theme_abyss() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))
```

This model evaluate ths the effects of Gender on valence, accounting for random variability due to participants. The analysis revealed that on average **women rate erotic stimuli significantly lower in valence than men**. 

```{r Valence3}
m_v <- glmmTMB::glmmTMB(Valence ~ Gender + (1|Participant), family=glmmTMB::ordbeta(),
                      data=df,
                      control = glmmTMB::glmmTMBControl(parallel = 8))
                      # control = glmmTMB::glmmTMBControl(optimizer=stats::optim, # nlminb, optim
                      #                                   optArgs = list(method = "BFGS"),  #Nelder-Mead, BFGS, CG
                      #                                   parallel = 8))

results_table(m_v)

```

```{r Valence plot}
estimate_relation(m_v) |> 
  ggplot(aes(x=Gender, y=Predicted)) +
  geom_pointrange(aes(ymin=CI_low, ymax=CI_high, color = Gender), position=position_dodge(width=0.5)) +
 scale_color_manual(values=c("Male"="#E91E63", "Female"="#FF9800"), guide="none") +  labs(y="Valence") +
  theme_abyss()
```

:::

## Arousal 

In contrast to [study1](https://realitybending.github.io/FictionEro/study1/analysis/2_emotions.html) arousal ratings for some images differ by whether the images were preceeded by 'photograph' or by 'AI-generated'. 

```{r Arousal Desc}
#| fig-height: 12
#| fig-width: 7


plot_descriptive <- function(df, target="Arousal") {
  # By item
  order <- df |>
    mutate(.Item_Order = paste0(Gender, "_", Stimulus)) |>
    summarize(mean = mean(.data[[target]], na.rm=TRUE), .by=c("Condition", ".Item_Order")) |> 
    arrange(.Item_Order, desc(Condition)) |> 
    mutate(diff = sign(mean - lag(mean)),
           Relevance = str_extract(.Item_Order, "^[^_]+"),
           .Item_Order = str_extract(.Item_Order, "(?<=_).+")) |>
    filter(Condition == "Photograph") |> 
    arrange(diff, mean)
    
  p1 <- df |>
    mutate(.Item_Order = paste0(Gender, "_", Stimulus)) |>
    group_by(.Item_Order, Condition) |>
    ggdist::mean_qi(.data[[target]], .width=0.95) |>
    mutate(Gender = fct_rev(str_extract(.Item_Order, "^[^_]+"))) |>
    left_join(order[c(".Item_Order", "diff")], by=".Item_Order") |>
mutate(.Item_Order = fct_relevel(.Item_Order, intersect(order$.Item_Order, unique(.Item_Order)))) |>
    # mutate(.average = mean(.data[[target]]), .by="Item") |>
    # mutate(Item = fct_reorder(Item, .average)) |>
    ggplot(aes(y = .Item_Order, x=.data[[target]])) +
    geom_line(aes(color=as.factor(diff)), linewidth=1) +
    geom_point(aes(color=Condition), size=2) +
      
    # ggdist::stat_slabinterval(aes(fill=Condition, color=Condition),
    #                           .width=0.95, normalize="xy", slab_alpha=0.5) +
    # ggdist::stat_histinterval(aes(fill=Condition, color=Condition),
    #                           .width=0.95, normalize="xy", slab_alpha=0.5) +
    scale_color_manual(values=c("AI-Generated"="#2196F3", "Photograph"="#F44336", "1"="#F44336", "-1"="#2196F3"),
                       breaks = c('AI-Generated', 'Photograph')) +
    # scale_fill_manual(values=c("AI-Generated"="#2196F3", "Photograph"="#F44336")) +
    scale_y_discrete(labels = function(x) str_extract(x, "(?<=_).+")) +
    theme_minimal() +
    theme(panel.grid.minor.x = element_blank(),
          # panel.grid.major.x = element_blank(),
          panel.border = element_blank(),
          axis.line.x = element_blank()) +
    labs(title = paste0(target, " by Item"), color="Condition", y="Items") +
    facet_wrap(~Gender, scales="free_y")

  # By participant
  p2 <- df |>
    summarize(.average = mean(.data[[target]]),
              .by=c("Gender", "Participant", "Condition")) |>
    pivot_wider(names_from = Condition, values_from = .average) |>
    mutate(.diff = Photograph - `AI-Generated`) |>
    mutate(Participant = fct_reorder(Participant, .diff)) |>
    ggplot(aes(x = .diff, y=Participant)) +
    geom_bar(aes(fill=.diff), stat = "identity")  +
    scale_fill_gradient2(guide="none", low="red", high="red", mid="blue") +
    labs(title = paste0(target, " by Participant")) +
    facet_wrap(~Gender, ncol=2, scales="free_y") +
    theme_minimal() +
    theme(panel.grid.major.y = element_blank(),
          panel.border = element_blank(),
          axis.line.x = element_blank(),
          axis.text.y = element_blank()) +
    labs(title = paste0(target, " by Participant"), x="Difference (Photograph - AI-Generated)", y="Participants")

  p1 / p2 + plot_layout(heights = c(2, 1))
}

# remove other 
arousal_desc <- df |> 
  filter(Gender != "Other") |> 
  plot_descriptive("Arousal")

arousal_desc
```

### Whole Sample

This model examines the effect of **Gender and Condition on Arousal**, accounting for random variability due to participants and items (i.e., random intercepts).

<!-- The intercept is Male and photograph.  -->
Women rated 'photographs' significantly lower in arousal than men. Men rated 'photographs' significantly higher in arousal than 'AI-generated' images.

The analysis also examined the average marginal effect of the variable "Condition" (comparing AI-Generated to Photograph) separately for males and females. For males, the arousal is on average significantly lower (althoug only slighly) for AI-Generated images compared to Photograph images. For females, the arousal is on average slightly lower for AI-Generated images compared to Photograph images; however, this effect is not significant.


```{r Arousal Model}

m_arousal <- glmmTMB::glmmTMB(Arousal ~ Gender/ Condition + 
                                (1| Participant) + (1|Stimulus), family=glmmTMB::ordbeta(),
                              data=df, control = glmmTMB::glmmTMBControl(parallel = 8))

results_table(m_arousal)

marginaleffects::avg_slopes(m_arousal, variables="Condition", by="Gender") 
# > results_table()

```

### Moderators

This model explores whether various factors such as **attitudes towards AI, knowledge about AI, frequency of porn consumption, and sexual activity** moderate the relationship between gender, image relevance (specifically AI-generated versus photographs), and arousal ratings.

The analysis revealed a significant interaction effect only for **positive attitudes towards AI** among females. Specifically, females with higher positive attitudes towards AI rated AI-generated images as more arousing, relative to when they viewed images labelled as photographs. 

No other moderators showed statistically significant effects on arousal across the interactions of gender, condition (AI-generated vs Photograph), and the respective moderators.

We also examined whether **feedback** moderates the relationship between gender and condition on arousal. Findings suggest that feedback moderates this relationship only for men. Specifically, males who reported finding AI-generated images as less and more arousing had lower and higher, respectively, arousal ratings for those images.

Lastly, the interaction between sexual activity and condition on Arousal levels. The three-way interaction between gender, condition (AI-Generated), and sexual activity did not reach statistical significance for either males or females, suggesting that the relationship between the AI-Generated condition and arousal ratings does not significantly vary with sexual activity levels for either gender.

<!-- All significant findings for feedback  -->

<!-- 1.For Males, giving feedback indicating that AI-generated images were less attractive, influenced arousal ratings for images labeled as AI-generated. Specifically, males who reported finding AI-generated images as less arousing had lower arousal ratings for those images. 


<!-- 2. For Males, giving feedback indicating that AI-generated images were more attractive significantly influenced arousal ratings for images labeled as AI-generated. Specifically, males who reported finding AI-generated images more attractive had higher arousal ratings for these images.  -->


<!-- Note: The feedback that the difference between the conditions was subtle only had one value - i.e., False.  The feedback that some AI images were arousing and that no AI images were arousing also only had one value - i.e., False -->


```{r Arousal Moderator}
test_moderator <- function(df, outcome="Arousal", moderator="BAIT_Visual") {
  f <- paste0(outcome, " ~ Gender / (Condition * ", moderator, ") + (Condition | Participant) + (1|Stimulus)")
  r <- glmmTMB::glmmTMB(as.formula(f),
                      data = df,
                      family=glmmTMB::ordbeta(),
                      control = glmmTMB::glmmTMBControl(parallel = 8)) |>
    parameters::parameters() |> 
    as.data.frame() |> 
    select(-df_error, -Effects, -Group, -Component, -SE)
  r$Moderator <- moderator
  r$Outcome <- outcome
  insight::format_table(r[c(7, 8), ])
}


moderator_results <- data.frame()
for(m in c("BAIT_Visual", "BAIT_Text", "BAIT_ExpertAI", "BAIT_Positive", "BAIT_Negative", "PornFrequency", "SexualActivity_num")) {
  moderator_results <- rbind(moderator_results,
                             test_moderator(df, "Arousal", m))
}

display(moderator_results)
```


```{r Arousal Moderator Feedback}
feedback_results <- data.frame()
for(m in c("Feedback_NoFacesAttractive", "Feedback_SomeFacesAttractive",
           "Feedback_AIMoreAttractive", "Feedback_AILessAttractive",
           "Feedback_AIMoreArousing", "Feedback_AILessArousing", 
            
           "Feedback_DiffObvious", "Feedback_DiffNone",
           
           "Feedback_LabelsIncorrect", "Feedback_LabelsReversed",
           "Feedback_AllReal", "Feedback_AllFake",
           
           "AllRealConfidence","AllFakeConfidence" ,
           "Enjoyment")) {
  feedback_results <- rbind(feedback_results,
                            test_moderator(df, "Arousal", m))
}
display(feedback_results)

```

```{r Arousal Sexual Activity}

m <- glmmTMB::glmmTMB(Arousal ~ Gender / (Condition * SexualActivity_num) + (Condition | Participant) + (1|Stimulus),
                      data=filter(df, ConditionBelief == "True"), 
                      family=glmmTMB::ordbeta(),
                      control = glmmTMB::glmmTMBControl(parallel = 8))

results_table(m)

sex_act_plot<- estimate_relation(m, length=20) |> 
  ggplot(aes(x=SexualActivity_num, y=Predicted)) +
  geom_ribbon(aes(ymin=CI_low, ymax=CI_high, fill=Condition), alpha=0.2) +
  geom_line(aes(color=Condition)) +
  facet_grid(~Gender)

sex_act_plot
```

### Believed

```{r Arousal Believed}
m <- glmmTMB::glmmTMB(Arousal ~ Gender / Condition + (1|Participant) + (1|Stimulus),
                        data=filter(df, ConditionBelief == "True"), 
                        family=glmmTMB::ordbeta(),
                        control = glmmTMB::glmmTMBControl(parallel = 8))
  
results_table(m)
```

```{r Arousal Believed2}

moderator_believed <- data.frame()
for(m in c("BAIT_Visual", "BAIT_Text", "BAIT_ExpertAI",
             "BAIT_Positive", "BAIT_Negative",
             "PornFrequency", "SexualActivity", 
             "Feedback_DiffObvious", "Feedback_DiffNone",
             "Feedback_AIMoreArousing", "Feedback_AILessArousing", 
             "Feedback_AIMoreAttractive", "Feedback_AILessAttractive",
             "Feedback_LabelsIncorrect", "Feedback_LabelsReversed")) {
    moderator_believed <- rbind(moderator_believed,
                               test_moderator(filter(df, ConditionBelief == "True"), "Arousal", m))
  }
  
  display(filter(moderator_believed, p < .1))

```

## Enticement 

Enticment ratings, for some images, differ by whether the images were preceeded by 'photograph' or by 'AI-generated'.


```{r Enticement Desc}
#| fig-height: 12
#| fig-width: 7

enticement_desc <- plot_descriptive(df, "Enticing")
enticement_desc
```


### Whole Sample

This model examines how **Gender and Condition influence enticement** ratings, treating participant and items as random intercepts.

<!-- Key Findings: -->

Across both conditions, women rated the images as less enticing overall than men.
There was a significant interaction between gender and image condition, whereby men were less enticed by AI-generated images, whereas women showed no significant difference in enticement based on image condition. 

We also analyzed the average marginal effect of the variable “Condition” (comparing AI-Generated to Photograph) separately for males and females. For males, enticement ratings are significantly lower on average for AI-Generated images compared to Photograph  images. For females, enticement ratings are slightly lower on average for AI-Generated images compared to Photograph images, although this difference is not statistically significant.

```{r Enticement Model}
m_enticement <- glmmTMB::glmmTMB(Enticing ~ Gender / Condition + 
                                   (1 | Participant) + (1|Stimulus),
                      data=df, family=glmmTMB::ordbeta(),
                      control = glmmTMB::glmmTMBControl(parallel = 8))

results_table(m_enticement)

marginaleffects::avg_slopes(m_enticement, variables="Condition", by="Gender", re.form=NA)
```

### Moderators

We examined whether **attitudes towards AI, porn frequency, and sexual activity** moderated the relationship between the predictors (sex, relevance, condition) and enticement ratings. The results showed that enticing ratings for images labeled AI-generated were moderated by the feedback reporting attitudes towards AI, but this was only significant for women. Specifically, women who reported having more positive attitudes towards AI, rated these images higher in arousal compared to images labeled as photographs.

Looking at **feedback as a moderator**, the results showed that enticement ratings for images labelled as AI-Generated were moderated by the feedback that AI is less attractive for males, and that difference between the AI-Generated images and real photos is obvious for females. Specifically, 

Lastly, the interaction between sexual activity and condition on enticement, suggests that enticement ratings do not significantly differ with sexual activity levels for either gender. 

<!-- Note: Feedback that 'No Images were Arousing' , 'Some Images were Arousing' and the 'difference between real and photos was Subtle' only had 1 level, hence were excluded from the following analysis -->
```{r Enticement Moderator}
for(m in c("BAIT_Visual", "BAIT_Text", "BAIT_ExpertAI",
           "BAIT_Positive", "BAIT_Negative",
           "PornFrequency", "SexualActivity")) {
  moderator_results <- rbind(moderator_results,
                             test_moderator(df, "Enticing", m))
}

display(filter(moderator_results, Outcome == "Enticing"))
```


```{r Enticement Moderator Feedback}
for(m in c("Feedback_NoFacesAttractive", "Feedback_SomeFacesAttractive",
           "Feedback_AIMoreAttractive", "Feedback_AILessAttractive",
           "Feedback_AIMoreArousing", "Feedback_AILessArousing", 
            
           "Feedback_DiffObvious", "Feedback_DiffNone",
           
           "Feedback_LabelsIncorrect", "Feedback_LabelsReversed",
           "Feedback_AllReal", "Feedback_AllFake")) {
  feedback_results <- rbind(feedback_results,
                            test_moderator(df, "Enticing", m))
}

display(filter(feedback_results, Outcome == "Enticing"))
```


```{r Enticement Sexual Activity}
m <- glmmTMB::glmmTMB(Enticing ~ Gender / (Condition * SexualActivity_num) + (Condition | Participant) + (1|Stimulus),
                      data=filter(df, ConditionBelief == "True"), 
                      family=glmmTMB::ordbeta(),
                      control = glmmTMB::glmmTMBControl(parallel = 8))

results_table(m)

sex_act_plot_ent<- estimate_relation(m, length=20) |> 
  ggplot(aes(x=SexualActivity_num, y=Predicted)) +
  geom_ribbon(aes(ymin=CI_low, ymax=CI_high, fill=Condition), alpha=0.2) +
  geom_line(aes(color=Condition)) +
  facet_grid(~Gender)

sex_act_plot_ent
```

### Believed

<!-- Effect becomes larger, more significant and goes in both directions for both genders -->

```{r Enticement Believed1}
m <- glmmTMB::glmmTMB(Enticing ~ Gender / Condition + (1 | Participant) + (1|Stimulus),
                      data=filter(df, ConditionBelief == "True"), 
                      family=glmmTMB::ordbeta(),
                      control = glmmTMB::glmmTMBControl(parallel = 8))

results_table(m)
```

```{r Enticement Believed2}
for(m in c("BAIT_Visual", "BAIT_Text", "BAIT_ExpertAI",
           "BAIT_Positive", "BAIT_Negative", "PornFrequency", "SexualActivity", 
           
           "Feedback_DiffObvious", "Feedback_DiffNone",
           "Feedback_AIMoreArousing", "Feedback_AILessArousing",
           "Feedback_AIMoreAttractive", "Feedback_AILessArousing",
           "Feedback_LabelsIncorrect", "Feedback_LabelsReversed")) {
  moderator_believed <- rbind(moderator_believed,
                             test_moderator(filter(df, ConditionBelief == "True"), "Enticing", m))
}

display(filter(moderator_believed, p < .1))
```

## Valence

```{r Valence Desc}
#| fig-height: 12
#| fig-width: 7

valence_desc <- plot_descriptive(df, "Valence")
valence_desc
```

### Whole Sample

This model examines the effect of **Gender and Condition on Valence** ratings, while accounting for random variability due to participants and items (i.e., random intercepts).

<!-- The intercept is Male and photograph.  -->
Male participants rated images labelled as AI-Generated significantly lower in valence than Real images. For females, there is no significant effect.


```{r Valence Model}
m_valence <- glmmTMB::glmmTMB(Valence ~ Gender / Condition + 
                                (1| Participant) + (1|Stimulus),
                      data=df, family=glmmTMB::ordbeta(),
                      control = glmmTMB::glmmTMBControl(parallel = 8))

results_table(m_valence)

marginaleffects::avg_slopes(m_valence, variables="Condition", by="Gender", re.form=NA)
```


### Moderators

Here we look at whether the relationship between gender and condition and valence is moderated by **AI-attitudes, porn frequency, and sexual activity**. The results showed that enticing ratings for images labeled AI-generated were moderated by the feedback reporting attitudes towards AI, but this was only significant for women. More specifically, females who have more positive and negative attitudes towards AI rated images labelled as AI-Generated significantly higher and lower in valence compared to images labelled as photographs.

Looking at **feedback** as a moderator, the results show that valence ratings for images labelled AI-Generated were moderted by the feedback that the difference between AI and Photos was obvious, but only for females. 

```{r Valence Moderator}
for(m in c("BAIT_Visual", "BAIT_Text", "BAIT_ExpertAI",
           "BAIT_Positive", "BAIT_Negative", "PornFrequency", "SexualActivity_num")) {
  moderator_results <- rbind(moderator_results,
                             test_moderator(df, "Valence", m))
}

display(filter(moderator_results, Outcome == "Valence"))
```

```{r Valence Moderator Feedback}
for(m in c("Feedback_NoFacesAttractive", "Feedback_SomeFacesAttractive",
           "Feedback_AIMoreAttractive", "Feedback_AILessAttractive",
           "Feedback_AIMoreArousing", "Feedback_AILessArousing", 
            
           "Feedback_DiffObvious", "Feedback_DiffNone",
           
           "Feedback_LabelsIncorrect", "Feedback_LabelsReversed",
           "Feedback_AllReal", "Feedback_AllFake",
           
           "AllRealConfidence","AllFakeConfidence" ,
           "Enjoyment")) {
  feedback_results <- rbind(feedback_results,
                            test_moderator(df, "Valence", m))
}
display(filter(feedback_results, Outcome == "Valence"))
```

### Believed

```{r Valence Believed1}
m <- glmmTMB::glmmTMB(Valence ~ Gender /Condition + (1| Participant) + (1|Stimulus),
                      data=filter(df, ConditionBelief == "True"), 
                      family=glmmTMB::ordbeta(),
                      control = glmmTMB::glmmTMBControl(parallel = 8))

results_table(m)

```

```{r Valence Beleived2}
for(m in c("BAIT_Visual", "BAIT_Text", "BAIT_ExpertAI",
           "BAIT_Positive", "BAIT_Negative", "PornFrequency", "SexualActivity", 
           
           "Feedback_DiffObvious", "Feedback_DiffNone",
           "Feedback_AIMoreArousing", "Feedback_AILessArousing",
           "Feedback_AIMoreAttractive", "Feedback_AILessArousing",
           "Feedback_LabelsIncorrect", "Feedback_LabelsReversed")) {
  moderator_believed <- rbind(moderator_believed,
                             test_moderator(filter(df, ConditionBelief == "True"), "Valence", m))
}

(filter(moderator_believed, p < .1))
```

## Emotionality (combined factor)

Here we combined the data for arousal, valence and enticing into an emotionality factor.

```{r Emotionality Factor}
pca <- principal_components(df[c("Valence", "Arousal", "Enticing")], n = 2)
pca
```

```{r EMotionality Plot}
df$Emotionality <- as.numeric(normalize(predict(pca)$PC1))

emotionality <- df |> 
  mutate(Emotionality_Extreme = ifelse(Emotionality %in% c(0, 1), "Extreme", "Not extreme")) |>
  ggplot(aes(x=Emotionality, fill = Gender)) +
  geom_histogram(aes(color=Emotionality_Extreme), position = "identity", bins=20) +
  facet_grid(~Gender, scales="free_y") +
  scale_color_manual(values=c("red", "white"), guide="none") +
  scale_fill_manual(values=c("Male"="#E91E63", "Female"="#FF9800"), guide="none") +
  scale_y_sqrt(expand = c(0, 0)) +
  labs(title = "Emotionality") +
  theme_abyss() +
  theme(plot.title = element_text(hjust = 0.5, face="bold"))

emotionality
```

```{r Emotionality Desc}
emotionality_desc <- plot_descriptive(df, "Emotionality")
emotionality_desc
```

### Whole Sample

This model looks at the effect of **Gender and Condition on Emotionality**, accounting for random variability due to participants and items (i.e., random intercepts).

The results show that females consistently rate photographs as higher in emotionality compared to males. Additonally, males rate AI-Generated images higher in emotionality compared to photographs. 

```{r Emotionality Model}
m <- glmmTMB::glmmTMB(Emotionality ~ Gender / Condition + (1| Participant) + (1|Stimulus),
                      data=df, family=glmmTMB::ordbeta(),
                      control = glmmTMB::glmmTMBControl(parallel = 8))

results_table(m)

marginaleffects::avg_slopes(m, variables="Condition", by="Gender", re.form=NA)
```

### Moderators

Looking at **AI-attitudes, porn frequency and sexual activity**, and feedback as moderators, we can see that for females, emotionality ratings for AI-generated images are negatively moderated by positive attitudes towards AI, meaning that females with more positive AI attitudes rate the images as less emotional. For males, emotionality ratings are positively moderated by negative attitudes towards AI, meaning that males with more negative AI attitudes rate the images as more emotional.

Looking at **feedback** as a moderator, the results show that emotionality ratings for AI-generated images were significantly moderated only by positive attitudes toward AI in females and negative attitudes toward AI in males.

Interestingly, for females, higher positive attitudes (BAIT Positive) were associated with lower emotionality ratings of AI-generated images. For males, higher negative attitudes (BAIT Negative) were associated with higher emotionality ratings.


```{r Emotionality Moderator}
for(m in c("BAIT_Visual", "BAIT_Text", "BAIT_ExpertAI",
           "BAIT_Positive", "BAIT_Negative", "PornFrequency", "SexualActivity_num")) {
  moderator_results <- rbind(moderator_results,
                             test_moderator(df, "Emotionality", m))
}

display(filter(moderator_results, Outcome == "Emotionality"))
```


```{r Emotionality Moderator Feedback}
for(m in c("Feedback_NoFacesAttractive", "Feedback_SomeFacesAttractive",
           "Feedback_AIMoreAttractive", "Feedback_AILessAttractive",
           "Feedback_AIMoreArousing", "Feedback_AILessArousing", 
            
           "Feedback_DiffObvious", "Feedback_DiffNone",
           
           "Feedback_LabelsIncorrect", "Feedback_LabelsReversed",
           "Feedback_AllReal", "Feedback_AllFake",
           
           "AllRealConfidence","AllFakeConfidence" ,
           "Enjoyment")) {
  feedback_results <- rbind(feedback_results,
                            test_moderator(df, "Emotionality", m))
}
display(filter(feedback_results, Outcome == "Emotionality"))
```

### Believed

```{r EMotionality Believed1}
m <- glmmTMB::glmmTMB(Emotionality ~ Gender / Condition + (1 | Participant) + (1|Stimulus),
                      data=filter(df, ConditionBelief == "True"), 
                      family=glmmTMB::ordbeta(),
                      control = glmmTMB::glmmTMBControl(parallel = 8))

results_table(m)

```

```{r Emotionality2}
for(m in c("BAIT_Visual", "BAIT_Text", "BAIT_ExpertAI",
           "BAIT_Positive", "BAIT_Negative", "PornFrequency", "SexualActivity", 
           
           "Feedback_DiffObvious", "Feedback_DiffNone",
           "Feedback_AIMoreArousing", "Feedback_AILessArousing",
           "Feedback_AIMoreAttractive", "Feedback_AILessArousing",
           "Feedback_LabelsIncorrect", "Feedback_LabelsReversed")) {
  moderator_believed <- rbind(moderator_believed,
                             test_moderator(filter(df, ConditionBelief == "True"), "Emotionality", m))
}

(filter(moderator_believed, p < .1))
```

## Summary

**Gender Differences**

- Main manipulation worked for men only - i.e., reality manipulation on the nature of the stimuli on subjective ratings

- Males rated AI-generated images significantly lower than photographs in arousal, valence, and enticement. Females showed no significant difference in ratings between AI-generated and photographic images across all outcomes.

- Women rate stimuli on average significantly lower in arousal, enticement and valence than men, however this difference was not significant for valence.

**Moderators**

- For women, **positive attitudes towards AI** moderated arousal, enticement, and valence ratings, resulting in **more favorable evaluations of AI-generated images**. Negative attitudes moderated valence ratings, leading to less favorable evaluations.

- For men, negative attitudes towards AI moderated only enticement ratings, with more negative views leading to less enticing ratings of AI-generated images.

- Men’s **perceptions of the attractiveness of AI-generated images** moderated both arousal and enticement ratings. More attractive AI images were rated as more arousing and enticing, while less attractive AI images were rated as less arousing.

- Women’s feedback about the differences between AI and real images being obvious moderated both enticement and valence ratings, with AI-generated images rated as less enticing and less valent. 


## Figures


## Notes/ Questions

1. 'Other' was removed due to the very small percentage of individuals identifying as such.
2. 'Porn' factor was not computed, instead sexual activity and frequency of watching porn were treated seperate. 
3. Missing final figures and interpretation of belief as influencing emotional ratings of images



