df1 <- modelbased::estimate_means(
model1, by = c("Gender", "Relevance", "Condition", "ConditionBelief"),backend = "emmeans") |>
dplyr::mutate(Sample = "Study 1") |>
as.data.frame()
# Study 2: only Relevant
if (!is.null(model2)) {
df2 <- modelbased::estimate_means(
model2, by = c("Gender", "Condition", "ConditionBelief"), backend = "emmeans") |>
dplyr::mutate(Relevance = "Relevant", Sample = "Study 2") |>
as.data.frame()
pred_df <- rbind(df1, df2)
} else {
pred_df <- df1
}
plt <- pred_df |>
ggplot(aes(x = ConditionBelief, y = Proportion,color = Condition, linetype = Sample, group = interaction(Sample, Condition)
)) +
geom_hline(yintercept = 0, color = "darkgrey") +
geom_line(linewidth = 1) +
geom_point(size = 2) +
geom_errorbar(aes(ymin = CI_low, ymax = CI_high), width = 0.1) +
facet_grid(Relevance ~ Gender, switch = "y", scales = "free") +
scale_color_manual(values = c("AI-Generated" = "#2196F3","Photograph" = "#F44336")) +
theme_minimal(base_size = 14) +
labs(title = title, x= "Whether the original labels were believed to be true",color = "Images presented as:", linetype = "Sample", caption = "Note. y axis scales are not equal accross relevance catgeories"
) +
theme(
axis.title.y = element_blank(),
axis.text.y = element_text(size = 8),
strip.placement = "outside",
strip.background.x = element_rect(fill = "lightgrey", color = NA),
strip.text.x = element_text(size = 10),
strip.text.y = element_text(size = 10),
axis.text.x = element_text(face = "bold", size = 9, color = "black"),
legend.text = element_text(size = 10),
legend.position = "bottom"
)
plt
}
plta <- make_combined_plot(arousal1, arousal2, title = "Arousal Estimates for All Stimuli")
plta
#| fig-height: 8
#| fig-width: 5
make_combined_plot <- function(model1, model2 = NULL,
title = "Estimated Marginal Means") {
df1 <- modelbased::estimate_means(
model1, by = c("Gender", "Relevance", "Condition", "ConditionBelief"),backend = "emmeans") |>
dplyr::mutate(Sample = "Study 1") |>
as.data.frame()
# Study 2: only Relevant
if (!is.null(model2)) {
df2 <- modelbased::estimate_means(
model2, by = c("Gender", "Condition", "ConditionBelief"), backend = "emmeans") |>
dplyr::mutate(Relevance = "Relevant", Sample = "Study 2") |>
as.data.frame()
pred_df <- rbind(df1, df2)
} else {
pred_df <- df1
}
plt <- pred_df |>
ggplot(aes(x = ConditionBelief, y = Proportion,color = Condition, linetype = Sample, group = interaction(Sample, Condition)
)) +
geom_hline(yintercept = 0, color = "darkgrey") +
geom_line(linewidth = 1) +
geom_point(size = 2) +
geom_errorbar(aes(ymin = CI_low, ymax = CI_high), width = 0.1) +
facet_grid(Relevance ~ Gender, switch = "y", scales = "free") +
scale_color_manual(values = c("AI-Generated" = "#2196F3","Photograph" = "#F44336")) +
theme_minimal(base_size = 14) +
labs(title = title, x= "Whether the original labels were believed to be true",color = "Images presented as:", linetype = "Sample", caption = "Note. y axis scales are not equal accross relevance catgeories"
) +
theme(
axis.title.y = element_blank(),
axis.text.y = element_text(size = 8),
strip.placement = "outside",
strip.background.x = element_rect(fill = "lightgrey", color = NA),
strip.text.x = element_text(size = 10),
strip.text.y = element_text(size = 10),
axis.text.x = element_text(face = "bold", size = 9, color = "black"),
legend.text = element_text(size = 10),
legend.position = "bottom",,
caption.position = "right"
)
plt
}
plta <- make_combined_plot(arousal1, arousal2, title = "Arousal Estimates for All Stimuli")
plta
#| fig-height: 8
#| fig-width: 5
make_combined_plot <- function(model1, model2 = NULL,
title = "Estimated Marginal Means") {
df1 <- modelbased::estimate_means(
model1, by = c("Gender", "Relevance", "Condition", "ConditionBelief"),backend = "emmeans") |>
dplyr::mutate(Sample = "Study 1") |>
as.data.frame()
# Study 2: only Relevant
if (!is.null(model2)) {
df2 <- modelbased::estimate_means(
model2, by = c("Gender", "Condition", "ConditionBelief"), backend = "emmeans") |>
dplyr::mutate(Relevance = "Relevant", Sample = "Study 2") |>
as.data.frame()
pred_df <- rbind(df1, df2)
} else {
pred_df <- df1
}
plt <- pred_df |>
ggplot(aes(x = ConditionBelief, y = Proportion,color = Condition, linetype = Sample, group = interaction(Sample, Condition)
)) +
geom_hline(yintercept = 0, color = "darkgrey") +
geom_line(linewidth = 1) +
geom_point(size = 2) +
geom_errorbar(aes(ymin = CI_low, ymax = CI_high), width = 0.1) +
facet_grid(Relevance ~ Gender, switch = "y", scales = "free") +
scale_color_manual(values = c("AI-Generated" = "#2196F3","Photograph" = "#F44336")) +
theme_minimal(base_size = 14) +
labs(title = title, x= "Whether the original labels were believed to be true",color = "Images presented as:", linetype = "Sample", caption = "Note. y axis scales are not equal accross relevance catgeories"
) +
theme(
axis.title.y = element_blank(),
axis.text.y = element_text(size = 8),
strip.placement = "outside",
strip.background.x = element_rect(fill = "lightgrey", color = NA),
strip.text.x = element_text(size = 10),
strip.text.y = element_text(size = 10),
axis.text.x = element_text(face = "bold", size = 9, color = "black"),
legend.text = element_text(size = 10),
legend.position = "bottom",,
caption.position = "right"
)
plt
}
plta <- make_combined_plot(arousal1, arousal2, title = "Arousal Estimates for All Stimuli")
plta
table_dvour <- function(g) {
performance::performance_dvour(g) |>
arrange(desc(D_vour)) |>
gt::gt() |>
gt::data_color("D_vour", palette = "green", domain = c(0, 1)) |>
gt::fmt_auto()
}
g1 <- modelbased::estimate_grouplevel(arousal1)
table_dvour(g1)
setwd("C:/Users/asf25/Desktop/studies/FictionEro/paper")
The study was conducted in line with the born-open principle [@de2024datapipe], ensuring transparency and reproducibility at every stage. The experiment was implemented entirely in jsPsych  [@de2015jspsych], with the full code hosted publicly on GitHub, which also served as the platform for running the online study. Raw data were automatically stored in a private Open Science Framework (OSF) repository. Anonymized data, together with all preprocessing and analysis scripts, will be openly released on GitHub to facilitate complete reproducibility.
?estimate_grouplevel
g1 <- modelbased::estimate_grouplevel(arousal1, type = "total")
table_dvour(g1)
check_reliability(arousal1)
?check_reliability()
?psych::check_reliability()
check_reliability(g1)
arousal1
modelbased::estimate_grouplevel(arousal1, type = "total")
g1 <- modelbased::estimate_grouplevel(arousal1, type = "total")
table_dvour(g1)
table_dvour <- function(g) {
performance::performance_dvour(g) |>
arrange(desc(D_vour)) |>
gt::gt() |>
gt::data_color("D_vour", palette = "green", domain = c(0, 1)) |>
gt::fmt_auto()
}
g1 <- modelbased::estimate_grouplevel(arousal1, type = "total")
table_dvour(g1)
setwd("C:/Users/asf25/Desktop/studies/FictionEro/analysis/server")
# Fit models
library(tidyverse)
library(easystats)
library(patchwork)
library(ggside)
library(glmmTMB)
options(mc.cores = parallel::detectCores(),
brms.backend = "cmdstanr",
width = 300)
# Study 1 ===================================================================================================================================
dfsub1 <- dfsub <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study1/data/data_participants.csv")
df1 <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study1/data/data.csv") |>
right_join(
select(dfsub, Participant, Sample, Language, Mobile, starts_with("Feedback_"),
BAIT_Visual, BAIT_Text, AI_Knowledge, SexualActivity,
GAAIS_Negative, GAAIS_Positive, Porn, COPS_Frequency_2,
Screen_Size,
-Feedback_Comments),
by = "Participant"
) |>
rename(Gender = Sex) |>
datawizard::rescale(select=c("Valence"), range=c(-1, 1), to=c(0, 1)) |>
mutate(Condition = fct_relevel(Condition, "Photograph", "AI-Generated"),
Relevance =  fct_relevel(Relevance, "Relevant", "Irrelevant", "Non-erotic"),
Gender =  fct_relevel(Gender, "Male", "Female"),
PornFrequency = as.numeric(as.factor(COPS_Frequency_2)),
SexualActivity_num = as.numeric(as.factor(SexualActivity)),
ConditionBelief = case_when(
Condition == "Photograph" & Realness > 0.5 ~ "True",
Condition == "AI-Generated" & Realness < 0.5 ~ "True",
.default = "False"
),
ConditionBelief = as.factor(ConditionBelief),
ConditionBelief = fct_relevel(ConditionBelief, "True", "False")) |>
mutate(across(starts_with("Feedback_"), function(x) {fct_relevel(x, "False", "True")}))
# MODELS --------
# Arousal
m_a1 <-  glmmTMB::glmmTMB(Arousal ~ Gender / Relevance/ Condition*ConditionBelief + (Condition:Relevance|Participant) + (1|Item),
data=df1,
family=glmmTMB::ordbeta(),
control = glmmTMB::glmmTMBControl(parallel = 8))
# Arousal
m_a1 <-  glmmTMB::glmmTMB(Arousal ~ Gender / Relevance/ Condition*ConditionBelief + (Condition/Participant) + (1|Item),
data=df1,
family=glmmTMB::ordbeta(),
control = glmmTMB::glmmTMBControl(parallel = 8))
m_a1 <-  glmmTMB::glmmTMB(Arousal ~ Gender / Relevance/ Condition*ConditionBelief + (Condition|Participant) + (1|Item),
data=df1,
family=glmmTMB::ordbeta(),
control = glmmTMB::glmmTMBControl(parallel = 8))
# Arousal
m_a2<-  glmmTMB::glmmTMB(Arousal ~ Gender / Condition*ConditionBelief + (Condition|Participant) + (1|Item),
data=df2,
family=glmmTMB::ordbeta(),
control = glmmTMB::glmmTMBControl(parallel = 8))
m_a2<-  glmmTMB::glmmTMB(Arousal ~ Gender / Condition*ConditionBelief + (Condition|Participant) + (1|Item),
data=df2,
family=glmmTMB::ordbeta(),
control = glmmTMB::glmmTMBControl(parallel = 8))
m_a2<-  glmmTMB::glmmTMB(Arousal ~ Gender / Condition*ConditionBelief + (Condition|Participant) + (1|Item),
data=df2,
family=glmmTMB::ordbeta(),
control = glmmTMB::glmmTMBControl(parallel = 8))
table_dvour <- function(g) {
performance::performance_dvour(g) |>
arrange(desc(D_vour)) |>
gt::gt() |>
gt::data_color("D_vour", palette = "green", domain = c(0, 1)) |>
gt::fmt_auto()
}
g1 <- modelbased::estimate_grouplevel(m_a2, type = "total")
table_dvour(g1)
g1
table_dvour(g1)
check_reliability(g1)
performance::check_reliability(g1)
install.packages("performance")
check_reliability(g1)
# Fit models
library(tidyverse)
library(easystats)
library(patchwork)
library(ggside)
library(glmmTMB)
library(brms)
install.packages("brms")
# Fit models
library(tidyverse)
library(easystats)
library(patchwork)
library(ggside)
library(glmmTMB)
library(brms)
options(mc.cores = parallel::detectCores(),
brms.backend = "cmdstanr",
width = 300)
# Study 1 ===================================================================================================================================
dfsub1 <- dfsub <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study1/data/data_participants.csv")
df1 <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study1/data/data.csv") |>
right_join(
select(dfsub, Participant, Sample, Language, Mobile, starts_with("Feedback_"),
BAIT_Visual, BAIT_Text, AI_Knowledge, SexualActivity,
GAAIS_Negative, GAAIS_Positive, Porn, COPS_Frequency_2,
Screen_Size,
-Feedback_Comments),
by = "Participant"
) |>
rename(Gender = Sex) |>
datawizard::rescale(select=c("Valence"), range=c(-1, 1), to=c(0, 1)) |>
mutate(Condition = fct_relevel(Condition, "Photograph", "AI-Generated"),
Relevance =  fct_relevel(Relevance, "Relevant", "Irrelevant", "Non-erotic"),
Gender =  fct_relevel(Gender, "Male", "Female"),
PornFrequency = as.numeric(as.factor(COPS_Frequency_2)),
SexualActivity_num = as.numeric(as.factor(SexualActivity)),
ConditionBelief = case_when(
Condition == "Photograph" & Realness > 0.5 ~ "True",
Condition == "AI-Generated" & Realness < 0.5 ~ "True",
.default = "False"
),
ConditionBelief = as.factor(ConditionBelief),
ConditionBelief = fct_relevel(ConditionBelief, "True", "False")) |>
mutate(across(starts_with("Feedback_"), function(x) {fct_relevel(x, "False", "True")}))
df1[1:2,] # keep only 2 participants to test locally
# MODELS --------
# Arousal
# random slopes that did not converge: (Condition:Relevance/ Participant) +
m_a1 <-  brms::brm(Arousal ~ Gender / Relevance/ Condition*ConditionBelief + (1|Participant) + (1|Item),
data=df1, family=zero_one_inflated_beta())
# install.packages("remotes")
remotes::install_github("stan-dev/cmdstanr")
install.packages("remotes")
# install.packages("remotes")
remotes::install_github("stan-dev/cmdstanr")
# Fit models
library(tidyverse)
library(easystats)
library(patchwork)
library(ggside)
library(glmmTMB)
library(brms)
options(mc.cores = parallel::detectCores(),
brms.backend = "cmdstanr",
width = 300)
# Study 1 ===================================================================================================================================
dfsub1 <- dfsub <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study1/data/data_participants.csv")
df1 <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study1/data/data.csv") |>
right_join(
select(dfsub, Participant, Sample, Language, Mobile, starts_with("Feedback_"),
BAIT_Visual, BAIT_Text, AI_Knowledge, SexualActivity,
GAAIS_Negative, GAAIS_Positive, Porn, COPS_Frequency_2,
Screen_Size,
-Feedback_Comments),
by = "Participant"
) |>
rename(Gender = Sex) |>
datawizard::rescale(select=c("Valence"), range=c(-1, 1), to=c(0, 1)) |>
mutate(Condition = fct_relevel(Condition, "Photograph", "AI-Generated"),
Relevance =  fct_relevel(Relevance, "Relevant", "Irrelevant", "Non-erotic"),
Gender =  fct_relevel(Gender, "Male", "Female"),
PornFrequency = as.numeric(as.factor(COPS_Frequency_2)),
SexualActivity_num = as.numeric(as.factor(SexualActivity)),
ConditionBelief = case_when(
Condition == "Photograph" & Realness > 0.5 ~ "True",
Condition == "AI-Generated" & Realness < 0.5 ~ "True",
.default = "False"
),
ConditionBelief = as.factor(ConditionBelief),
ConditionBelief = fct_relevel(ConditionBelief, "True", "False")) |>
mutate(across(starts_with("Feedback_"), function(x) {fct_relevel(x, "False", "True")}))
df1[1:2,] # keep only 2 participants to test locally
# MODELS --------
# Arousal
# random slopes that did not converge: (Condition:Relevance/ Participant) +
m_a1 <-  brms::brm(Arousal ~ Gender / Relevance/ Condition*ConditionBelief + (1|Participant) + (1|Item),
data=df1, family=zero_one_inflated_beta())
R.Version()
# Fit models
library(tidyverse)
library(easystats)
library(patchwork)
library(ggside)
library(glmmTMB)
library(brms)
options(mc.cores = parallel::detectCores(),
brms.backend = "cmdstanr",
width = 300)
# Study 1 ===================================================================================================================================
dfsub1 <- dfsub <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study1/data/data_participants.csv")
df1 <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study1/data/data.csv") |>
right_join(
select(dfsub, Participant, Sample, Language, Mobile, starts_with("Feedback_"),
BAIT_Visual, BAIT_Text, AI_Knowledge, SexualActivity,
GAAIS_Negative, GAAIS_Positive, Porn, COPS_Frequency_2,
Screen_Size,
-Feedback_Comments),
by = "Participant"
) |>
rename(Gender = Sex) |>
datawizard::rescale(select=c("Valence"), range=c(-1, 1), to=c(0, 1)) |>
mutate(Condition = fct_relevel(Condition, "Photograph", "AI-Generated"),
Relevance =  fct_relevel(Relevance, "Relevant", "Irrelevant", "Non-erotic"),
Gender =  fct_relevel(Gender, "Male", "Female"),
PornFrequency = as.numeric(as.factor(COPS_Frequency_2)),
SexualActivity_num = as.numeric(as.factor(SexualActivity)),
ConditionBelief = case_when(
Condition == "Photograph" & Realness > 0.5 ~ "True",
Condition == "AI-Generated" & Realness < 0.5 ~ "True",
.default = "False"
),
ConditionBelief = as.factor(ConditionBelief),
ConditionBelief = fct_relevel(ConditionBelief, "True", "False")) |>
mutate(across(starts_with("Feedback_"), function(x) {fct_relevel(x, "False", "True")}))
df1[1:2,] # keep only 2 participants to test locally
# MODELS --------
# Arousal
# random slopes that did not converge: (Condition:Relevance/ Participant) +
m_a1 <-  brms::brm(Arousal ~ Gender / Relevance/ Condition*ConditionBelief + (1|Participant) + (1|Item),
data=df1, family=zero_one_inflated_beta())
# Enticement
m_e1 <-  brms::brm(Enticement ~ Gender /Relevance/Condition*ConditionBelief + (1|Participant) + (1|Item),
data=df1, family=zero_one_inflated_beta())
# Fit models
library(brms)
library(cmdstanr)
library(cogmod)
library(brms)
library(cmdstanr)
ptions(brms.backend = "cmdstanr")
options(brms.backend = "cmdstanr")
# Get array task ID from Slurm
task_id <- as.numeric(commandArgs(trailingOnly = TRUE)[1])
# Number of chains per task from Slurm (fixed at 16)
chains_per_task <- as.numeric(Sys.getenv("SLURM_CPUS_PER_TASK"))
# Calculate starting chain ID
start_chain <- (task_id - 1) * chains_per_task + 1
iter <- 1500 # 50% of that is warmup
dfsub1 <- dfsub <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study1/data/data_participants.csv")
df1 <- read.csv("https://raw.githubusercontent.com/RealityBending/FictionEro/refs/heads/main/study1/data/data.csv") |>
right_join(
select(dfsub, Participant, Sample, Language, Mobile, starts_with("Feedback_"),
BAIT_Visual, BAIT_Text, AI_Knowledge, SexualActivity,
GAAIS_Negative, GAAIS_Positive, Porn, COPS_Frequency_2,
Screen_Size,
-Feedback_Comments),
by = "Participant"
) |>
rename(Gender = Sex) |>
datawizard::rescale(select=c("Valence"), range=c(-1, 1), to=c(0, 1)) |>
mutate(Condition = fct_relevel(Condition, "Photograph", "AI-Generated"),
Relevance =  fct_relevel(Relevance, "Relevant", "Irrelevant", "Non-erotic"),
Gender =  fct_relevel(Gender, "Male", "Female"),
PornFrequency = as.numeric(as.factor(COPS_Frequency_2)),
SexualActivity_num = as.numeric(as.factor(SexualActivity)),
ConditionBelief = case_when(
Condition == "Photograph" & Realness > 0.5 ~ "True",
Condition == "AI-Generated" & Realness < 0.5 ~ "True",
.default = "False"
),
ConditionBelief = as.factor(ConditionBelief),
ConditionBelief = fct_relevel(ConditionBelief, "True", "False")) |>
mutate(across(starts_with("Feedback_"), function(x) {fct_relevel(x, "False", "True")}))
df1[1:2,]
f_e1 <- brms::brmsformula(Enticement ~ Gender / Relevance/ Condition*ConditionBelief + (1|Participant) + (1|Item))
m_e1 <-  brms::brm(
formula = f_e1,
data=df1,
family=zero_one_inflated_beta(),
cores = 10, init = 0,
chains = chains_per_task,    # 16 chains per task
cores = chains_per_task,     # Use all 16 CPUs
iter = iter,  # Number of iterations and warmup must be equal (warmup is 50% iter)
seed = 1234 + start_chain,   # Unique seed per task )
)
chains_per_task
Sys.getenv("SLURM_CPUS_PER_TASK")
m_e1 <-  brms::brm(
formula = f_e1,
data=df1,
family=zero_one_inflated_beta(),
init = 0,
chains = chains_per_task,    # 16 chains per task
cores = chains_per_task,     # Use all 16 CPUs
iter = iter,  # Number of iterations and warmup must be equal (warmup is 50% iter)
seed = 1234 + start_chain,   # Unique seed per task )
)
m_e1 <-  brms::brm(
formula = f_e1,
data=df1,
family=zero_one_inflated_beta(),
init = 0,
chains = 10,    # 16 chains per task
cores = 10,     # Use all 16 CPUs
iter = iter,  # Number of iterations and warmup must be equal (warmup is 50% iter)
seed = 1234 + start_chain,   # Unique seed per task )
)
as.numeric(commandArgs(trailingOnly = TRUE)[1])
m_e1 <-  brms::brm(
formula = f_e1,
data=df1,
family=zero_one_inflated_beta(),
init = 0,
chains = 10,    # 16 chains per task
cores = 10,     # Use all 16 CPUs
iter = iter,  # Number of iterations and warmup must be equal (warmup is 50% iter)
seed = 1234,   # Unique seed per task )
)
m_e1 <-  brms::brm(
formula = f_e1,
data=df1,
family=zero_one_inflated_beta(),
init = 0,
chains = 4,    # 16 chains per task
cores = 10,     # Use all 16 CPUs
iter = iter,  # Number of iterations and warmup must be equal (warmup is 50% iter)
seed = 1234,   # Unique seed per task )
)
m_e1 <-  brms::brm(
formula = f_e1,
data=df1,
family=zero_one_inflated_beta(),
init = 0,
chains = 4,    # 4 chains per task
cores = 8,     # Use all 10 CPUs
iter = iter,  # Number of iterations and warmup must be equal (warmup is 50% iter)
seed = 1234,   # Unique seed per task )
)
?brm
m_e1 <-  brms::brm(
formula = f_e1,
data=df1,
family=zero_one_inflated_beta(),
chains = 4,    # 4 chains per task
cores = 4,     # Use all 10 CPUs
iter = 500,  # Number of iterations and warmup must be equal (warmup is 50% iter)
seed = 1234,   # Unique seed per task )
)
m_e1 <-  brms::brm(
formula = f_e1,
data=df1,
family=zero_one_inflated_beta(),
chains = 2,
cores = 2,
iter = 500,
warmup = 250,
seed = 1234,
backend = "cmdstanr"
)
